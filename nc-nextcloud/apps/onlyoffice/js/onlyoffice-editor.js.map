{"version":3,"file":"onlyoffice-editor.js?v=e32b494d8991c1dce9fa","mappings":"CA4BA,SAAWA,EAAGC,GAEVA,EAAIC,WAAaC,EAAEC,OAAO,CAClBC,QAAS,aACTC,SAAS,EACTC,UAAU,EACVC,OAAQ,KACRC,WAAY,KACZC,gBAAiB,MAClBT,EAAIC,YAEXD,EAAIC,WAAWS,WAAa,WAExBV,EAAIC,WAAWM,OAASR,EAAE,iBAAiBY,KAAK,MAChDX,EAAIC,WAAWO,WAAaT,EAAE,iBAAiBY,KAAK,cACpD,IAAIC,EAAcb,EAAE,iBAAiBY,KAAK,eAC1CX,EAAIC,WAAWY,SAAWd,EAAE,iBAAiBY,KAAK,YAClDX,EAAIC,WAAWI,UAAYN,EAAE,iBAAiBY,KAAK,WACnDX,EAAIC,WAAWK,WAAaP,EAAE,iBAAiBY,KAAK,YACpDX,EAAIC,WAAWa,SAAWf,EAAE,iBAAiBY,KAAK,QAClDX,EAAIC,WAAWc,OAAShB,EAAE,iBAAiBiB,KAAK,eAChDhB,EAAIC,WAAWgB,UAAYlB,EAAE,iBAAiBiB,KAAK,kBACnD,IAAIE,EAAYC,aAAaC,QAAQ,QAWrC,GAVApB,EAAIC,WAAWoB,cAAgBC,OAC/BtB,EAAIC,WAAWsB,YAAcC,GAAGC,iBAE5BzB,EAAIC,WAAWI,UACfL,EAAIC,WAAWyB,YAAc3B,EAAE,oBAAoBiB,KAAK,QACxDhB,EAAIC,WAAWoB,cAAgBC,OAAOK,OACtC3B,EAAIC,WAAW2B,UAAY5B,EAAIC,WAAWoB,cAAcQ,SAASC,MACjE9B,EAAIC,WAAWsB,YAAcvB,EAAIC,WAAWoB,cAAcG,GAAGC,kBAG5DzB,EAAIC,WAAWM,QAAWP,EAAIC,WAAWO,YAAeI,EAK7D,GAAuB,oBAAZmB,QAAX,CAKA,IAAIC,EAAcD,QAAQE,UAAUC,UAAUC,MAAM,KACpD,GAAIH,EAAY,GAAK,GACI,GAAlBA,EAAY,IAA6B,GAAlBA,EAAY,GACtChC,EAAIC,WAAWmC,YAAYC,EAAErC,EAAIC,WAAWG,QAAS,yBAA0B,QAAS,CAACkC,SAAU,QAFvG,CAMA,IAAIC,EAAYf,GAAGgB,UAAU,QAAUxC,EAAIC,WAAWG,QAAU,iBAAkB,IAAMJ,EAAIC,WAAWM,QAAU,GAE7GkC,EAAS,GACT3B,EAAWf,EAAE,iBAAiBY,KAAK,QACnCG,GACA2B,EAAOC,KAAK,YAAcC,mBAAmB7B,IAE7Cd,EAAIC,WAAWO,YACfiC,EAAOC,KAAK,cAAgBC,mBAAmB3C,EAAIC,WAAWO,aAE9DI,IACAb,EAAE,QAAQ6C,SAAS,wBACnBH,EAAOC,KAAK,eAAiBC,mBAAmB/B,KAEhDZ,EAAIC,WAAWY,UACf4B,EAAOC,KAAK,iBAEZxB,GAA2B,SAAdA,GACbuB,EAAOC,KAAK,aAAeC,mBAAmBzB,IAE9ClB,EAAIC,WAAWc,QACf0B,EAAOC,KAAK,UAAYC,mBAAmB3C,EAAIC,WAAWc,SAE1Df,EAAIC,WAAWgB,WACfwB,EAAOC,KAAK,mBAGZ1C,EAAIC,WAAWI,SAAWO,IAC1B6B,EAAOC,KAAK,gBAGZ1C,EAAIC,WAAWK,UACfmC,EAAOC,KAAK,iBAGZ1C,EAAIC,WAAW4C,SACfJ,EAAOC,KAAK,gBAEZD,EAAOK,SACPP,GAAa,IAAME,EAAOM,KAAK,MAGnChD,EAAEiD,KAAK,CACHC,IAAKV,EACLW,QAAS,SAAmBC,GACxB,GAAIA,EAAQ,CAMR,GALAnD,EAAIC,WAAWmD,OAASD,EAAOE,KACD,WAA1BrD,EAAIC,WAAWmD,QACfpD,EAAIC,WAAWqD,eAGfH,EAAOI,YAEP,YADAC,SAASC,KAAON,EAAOI,aAI3B,GAAoB,MAAhBJ,EAAOO,MAEP,YADA1D,EAAIC,WAAWmC,YAAYe,EAAOO,MAAO,QAAS,CAACpB,SAAU,IAIjE,IAAIqB,EAAe,KACfC,EAAsB,KAEtBC,EAAe,SAAUC,GAGzB,GAFAC,aAAaH,GAETD,IAAiBG,EAAMnD,KAAM,CAC7B,IAAIqD,EAAc,WACdhE,EAAIC,WAAWoB,cAAcQ,SAASC,MAAQqB,EAAOtB,SAASC,OAASgC,EAAMnD,KAAO,KAAO,IAAM,MAAQsD,YAAYnC,MACrH6B,EAAeG,EAAMnD,IACzB,GAEc,IAAVmD,GAAmBA,EAAMnD,KACzBqD,IAEAJ,EAAsBM,WAAWF,EAAa,IAEtD,CACJ,EACAH,GAAa,GAEb7D,EAAIC,WAAWkE,aAAehB,EAAOgB,aAErChB,EAAOiB,OAAS,CACZ,sBAAyBP,EACzB,gBAAmB7D,EAAIC,WAAWoE,gBAClC,iBAAoBrE,EAAIC,WAAWqE,kBAGnCnB,EAAOoB,aAAaC,SACpBrB,EAAOiB,OAAOK,WAAa,WACvBzE,EAAIC,WAAWyE,UAAUtC,YAAYC,EAAErC,EAAIC,WAAWG,QAAS,iGACnE,IAGAJ,EAAIC,WAAWI,UAAYL,EAAIC,WAAWO,YACvCR,EAAIC,WAAWsB,YAAYoD,OAC9BxB,EAAOiB,OAAOQ,gBAAkB5E,EAAIC,WAAW2E,gBAC/CzB,EAAOiB,OAAOS,qBAAuB7E,EAAIC,WAAW4E,qBACpD1B,EAAOiB,OAAOU,6BAA+B9E,EAAIC,WAAW6E,6BAC5D3B,EAAOiB,OAAOW,qBAAuB/E,EAAIC,WAAW+E,wBACpD7B,EAAOiB,OAAOY,wBAA0BhF,EAAIC,WAAW+E,wBACvD7B,EAAOiB,OAAOa,oBAAsBjF,EAAIC,WAAWgF,oBACnD9B,EAAOiB,OAAOc,uBAAyBlF,EAAIC,WAAWiF,uBACtD/B,EAAOiB,OAAOe,cAAgBnF,EAAIC,WAAWkF,cAC7ChC,EAAOiB,OAAOgB,yBAA2BpF,EAAIC,WAAWmF,yBACxDjC,EAAOiB,OAAOiB,aAAerF,EAAIC,WAAWoF,aAExCrF,EAAIC,WAAWsB,YAAYoD,MAC3BxB,EAAOiB,OAAOkB,eAAiBtF,EAAIC,WAAWqF,gBAG7CtF,EAAIC,WAAWa,WAChBd,EAAIC,WAAWa,SAAWqC,EAAOoC,YAGhCvF,EAAIC,WAAWY,WAChBsC,EAAOiB,OAAOoB,iBAAmBxF,EAAIC,WAAWuF,iBAChDrC,EAAOiB,OAAOqB,qBAAuBzF,EAAIC,WAAWwF,qBACpDtC,EAAOiB,OAAOsB,iBAAmB1F,EAAIC,WAAWyF,iBAChDvC,EAAOiB,OAAOuB,sBAAwB3F,EAAIC,WAAW0F,yBAIzD3F,EAAIC,WAAW2F,cAAgB5F,EAAIC,WAAWI,WAC9C8C,EAAOiB,OAAOyB,eAAiB7F,EAAIC,WAAW4F,gBAG9C7F,EAAIC,WAAWI,SACZ8C,EAAO2C,iBAAmB9F,EAAIC,WAAWO,YACzCc,OAAOK,OAAO3B,IAAIC,WAAW8F,UAChC5C,EAAOiB,OAAO4B,yBAA2BhG,EAAIC,WAAW+F,2BAGvD7C,EAAOtB,SAASoE,YAAYC,MAC1B/C,EAAOtB,SAASoE,YAAYE,WAC5BhD,EAAOiD,UACVjD,EAAOiB,OAAOiC,oBAAsBrG,EAAIC,WAAWoG,qBAGvDrG,EAAIC,WAAWyE,UAAY,IAAI3C,QAAQE,UAAU,eAAgBkB,GAE7DnD,EAAIC,WAAW2F,cACf5F,EAAIC,WAAW2F,aAAaU,SAG3BtG,EAAIC,WAAW2F,cACG,WAAhBzC,EAAOE,MAA4D,UAAvCtD,EAAE,iBAAiBwG,IAAI,aACtDxG,EAAE,iBAAiBwG,IAAI,SAAU,qBAGrC,IAAIC,EAAUhF,GAAGV,SAASd,EAAIC,WAAWG,QAAS,MAAOJ,EAAIC,WAAWkE,aAAe,QACnFnE,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,gBACRC,MAAOH,GAEX,KAEAzG,EAAE,oBAAoBiB,KAAK,OAAQwF,EAE3C,CACJ,GArKJ,CAPA,MAFIxG,EAAIC,WAAWmC,YAAYC,EAAErC,EAAIC,WAAWG,QAAS,sDAAuD,QAAS,CAACkC,SAAU,SALhItC,EAAIC,WAAWmC,YAAYC,EAAErC,EAAIC,WAAWG,QAAS,mBAAoB,QAAS,CAACkC,SAAU,GAqLrG,EAEAtC,EAAIC,WAAWoG,oBAAsB,WAC7BrG,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,uBAEZ,KAGJlD,SAASC,MAAQ,iBACrB,EAEAzD,EAAIC,WAAWuF,iBAAmB,SAAUtD,GACxCnC,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,gCACpD,CACIG,OAAQP,EAAIC,WAAWM,QAAU,KAErC,SAAmBuG,GACf9G,EAAIC,WAAW8G,eAAeD,EAAU5E,EAChD,GACJ,EAEAlC,EAAIC,WAAWwF,qBAAuB,SAAU3B,GAC5C,IAAI5B,EAAU4B,EAAMnD,KAEpBZ,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,kDACpD,CACIG,OAAQP,EAAIC,WAAWM,QAAU,EACjC2B,QAASA,KAEb,SAAmB4E,GACXA,EAASpD,QACToD,EAAW,CACPpD,MAAOoD,EAASpD,MAChBxB,QAASA,IAGjBlC,EAAIC,WAAWyE,UAAUsC,eAAeF,EAChD,GACJ,EAEA9G,EAAIC,WAAWyF,iBAAmB,SAAU5B,GACxC,IAAI5B,EAAU4B,EAAMnD,KAAKuB,QAEzBnC,EAAEiD,KAAK,CACH0D,OAAQ,MACRzD,IAAKzB,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,iBACvDO,KAAM,CACFJ,OAAQP,EAAIC,WAAWM,QAAU,EACjC2B,QAASA,GAEbgB,QAAS,SAAmB4D,GACxB9G,EAAIC,WAAW8G,eAAeD,EAAU5E,GAEpClC,EAAIC,WAAWI,SACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,2BAEZ,IAER,GAER,EAEA1G,EAAIC,WAAW0F,sBAAwB,WACnCnC,SAASyD,QAAO,EACpB,EAEAjH,EAAIC,WAAWoE,gBAAkB,WACzBrE,EAAIC,WAAWI,SACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,kBACRC,MAAO,CAAC,GAEZ,KAGJ3G,EAAIC,WAAWiH,SACflH,EAAIC,WAAWkH,aACnB,EAEAnH,EAAIC,WAAW2E,gBAAkB,SAAUd,GACvC,IAAIsD,EAAW,CACXC,KAAMvD,EAAMnD,KAAKmB,MACjBmB,IAAKa,EAAMnD,KAAKsC,KAGpB,GAAIjD,EAAIC,WAAWa,SAAU,CACzB,IAAIwG,EAAYtH,EAAIC,WAAWa,SAASqB,MAAM,KAC9CmF,EAAUC,MACVD,EAAUE,QACVJ,EAASK,IAAM,IAAMH,EAAUvE,KAAK,IACxC,CAEI/C,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,sBACRC,MAAOS,GAEX,KAEA5F,GAAGkG,QAAQC,WAAWtF,EAAErC,EAAIC,WAAWG,QAAS,YAC5C,SAAUwH,GACNR,EAASK,IAAMG,EACf5H,EAAIC,WAAW4H,aAAaT,EAChC,IACA,EACA,wBACA,EACA5F,GAAGkG,QAAQI,uBACXV,EAASK,IAErB,EAEAzH,EAAIC,WAAW4H,aAAe,SAAUT,GACpCrH,EAAEgI,KAAKvG,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,cACrDgH,GACA,SAAmBN,GACXA,EAASpD,MACT1D,EAAIC,WAAWmC,YAAY0E,EAASpD,MAAO,SAI/C1D,EAAIC,WAAWmC,YAAYC,EAAErC,EAAIC,WAAWG,QAAS,cAAgB,KAAO0G,EAASO,KAAO,IAChG,GACR,EAEArH,EAAIC,WAAW4E,qBAAuB,SAAUf,GAC5C,IAAIkE,EAAa,CACb,YAAa,cAAe,iBAAkB,kBAC9C,YACA,aAAc,YAAa,kBAAmB,oBAC9C,YAAa,cAAe,kBAAmB,qBAG/ClE,EAAMnD,OACNX,EAAIC,WAAWQ,gBAAkBqD,EAAMnD,KAAKsH,GAG5CjI,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,2BACRC,MAAOqB,GAEX,KAEAxG,GAAGkG,QAAQC,WAAWtF,EAAErC,EAAIC,WAAWG,QAAS,gBAC5CJ,EAAIC,WAAWiI,mBACf,EACAF,GACA,EAEZ,EAEAhI,EAAIC,WAAWiI,kBAAoB,SAAUpH,GACzCf,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,gCACpD,CACIU,SAAUA,KAEd,SAAmBgG,GACXA,EAASpD,MACT1D,EAAIC,WAAWmC,YAAY0E,EAASpD,MAAO,UAI3C1D,EAAIC,WAAWQ,kBACfqG,EAASmB,EAAIjI,EAAIC,WAAWQ,iBAGhCT,EAAIC,WAAWyE,UAAUyD,YAAYrB,GACzC,GACR,EAEA9G,EAAIC,WAAW6E,6BAA+B,WAC1C,IAAIsD,EAAiB,CACjB,qEAGApI,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,mCACRC,MAAOyB,GAEX,KAEA5G,GAAGkG,QAAQC,WAAWtF,EAAErC,EAAIC,WAAWG,QAAS,qBAC5CJ,EAAIC,WAAWoI,oBACf,EACAD,GACA,EAEZ,EAEApI,EAAIC,WAAWoI,mBAAqB,SAAUvH,GAC1Cf,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,gCACpD,CACIU,SAAUA,KAEd,SAAmBgG,GACXA,EAASpD,MACT1D,EAAIC,WAAWmC,YAAY0E,EAASpD,MAAO,SAI/C1D,EAAIC,WAAWyE,UAAU4D,uBAAuBxB,EACpD,GACR,EAEA9G,EAAIC,WAAWsI,sBAAwB,SAAUzH,GACzCA,IAAad,EAAIC,WAAWa,SAKhCf,EAAEgI,KAAKvG,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,mBACzD,CACIoI,KAAM1H,IAEV,SAAmBgG,GACXA,EAASpD,MACT1D,EAAIC,WAAWmC,YAAY0E,EAASpD,MAAO,SAG/C1D,EAAIC,WAAWyE,UAAU+D,mBAAmB3B,EAChD,IAdI9G,EAAIC,WAAWmC,YAAYC,EAAErC,EAAIC,WAAWG,QAAS,oDAAqD,QAelH,EAEAJ,EAAIC,WAAW4F,eAAiB,WACxB7F,EAAIC,WAAW2F,aACf5F,EAAIC,WAAW2F,aAAa8C,SAIhC1I,EAAIC,WAAWyE,UAAUiE,gBAEzBrH,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,sBAEZ,KACJ,EAEA1G,EAAIC,WAAW+F,yBAA2B,WACtC1E,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,gCAEZ,IACJ,EAEA1G,EAAIC,WAAW+E,wBAA0B,SAAUlB,GAC/C,IAAI8E,EAAe,CACf,2EAGJ,GAAI5I,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,8BACRC,MAAOiC,EACPC,sBAAuB/E,EAAMnD,KAAKsH,GAEtC,SACG,CACH,GACS,YADDnE,EAAMnD,KAAKsH,EAEX,IAAInG,EAASO,EAAErC,EAAIC,WAAWG,QAAS,+BAGvC0B,EAASO,EAAErC,EAAIC,WAAWG,QAAS,0BAE3CoB,GAAGkG,QAAQC,WAAW7F,EAClB9B,EAAIC,WAAW6I,mBAAmBC,KAAK,CAACF,sBAAuB/E,EAAMnD,KAAKsH,KAC1E,EACAW,GACA,EACR,CACJ,EAEA5I,EAAIC,WAAW6I,mBAAqB,SAAUhI,GAC1C,IAAI+H,EAAwBG,KAAKH,sBACjC9I,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,gCACpD,CACIU,SAAUA,KAEd,SAAmBgG,GACXA,EAASpD,MACTuF,IAAIC,MAAMxF,MAAMoD,EAASpD,QAG7BoD,EAASmB,EAAIY,EAEb7I,EAAIC,WAAWyE,UAAUyE,qBAAqBrC,GAClD,GACR,EAEA9G,EAAIC,WAAWqE,iBAAmB,SAAUR,GACxC,IAAIb,EAAMO,SAASC,KACnB,GAAIK,GAASA,EAAMnD,KAAM,CACrB,IAAIyI,EAAcnG,EAAIoG,QAAQ,MACV,GAAhBD,IACAnG,EAAMA,EAAIqG,UAAU,EAAGF,IAG3B,IAAIzI,EAAO4I,KAAKC,UAAU1F,EAAMnD,MAChCA,EAAO,UAAYgC,mBAAmBhC,GAEtC,IAAI8I,EAAe,qBACfA,EAAaC,KAAKzG,KAClBA,EAAMA,EAAI0G,QAAQF,EAAc9I,IAGpC,IAAIiJ,EAAc,kBACdA,EAAYF,KAAKzG,GACjBA,EAAMA,EAAI0G,QAAQC,EAAajJ,IAE/BsC,IAA6B,GAArBA,EAAIoG,QAAQ,KAAc,IAAM,IACxCpG,GAAOtC,EAEf,CAEAX,EAAIC,WAAWyE,UAAUmF,cAAc5G,EAC3C,EAEAjD,EAAIC,WAAWqF,eAAiB,SAAUxB,GACtC,IAAIgG,OAAyC,IAAlBhG,EAAMnD,KAAKsH,EAAqBnE,EAAMnD,KAAKsH,EAAI,KAEjE,SADD6B,EAEI/J,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,mCACxD,CACI2J,QAASR,KAAKC,UAAU1F,EAAMnD,KAAKqJ,OAEvC,SAAmBlD,GACf9G,EAAIC,WAAWyE,UAAUuF,SAAS,CAC9B,EAAKH,EACL,MAAShD,GAEjB,IAGA/G,EAAE6G,IAAIpF,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,6CAA+C0J,EACvG,CACIvJ,OAAQP,EAAIC,WAAWM,QAAU,KAErC,SAAmBuG,GACf9G,EAAIC,WAAWyE,UAAUuF,SAAS,CAC9B,EAAKH,EACL,MAAShD,GAEjB,GAEhB,EAEA9G,EAAIC,WAAWgF,oBAAsB,SAAUnB,GAC3C,IAAIoG,EAAapG,EAAMnD,KAAKuJ,WACxBC,EAAUrG,EAAMnD,KAAKyJ,QACrBC,EAASvG,EAAMnD,KAAK0J,OAEpB9J,EAASP,EAAIC,WAAWM,OAE5BR,EAAEgI,KAAKvG,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,iBACrD,CACIG,OAAQA,EACRQ,OAAQwI,KAAKC,UAAUU,GACvBC,QAASA,EACTE,OAAQA,IAEZ,SAAmBvD,GACXA,EAASpD,MACT1D,EAAIC,WAAWmC,YAAY0E,EAASpD,MAAO,SAI/C1D,EAAIC,WAAWmC,YAAY0E,EAASsD,QACxC,GACR,EAEApK,EAAIC,WAAWiF,uBAAyB,SAAUpB,GAC9C,IAAIwG,EAAgBxG,EAAMnD,KAAK2J,cAC3B9B,EAAO1E,EAAMnD,KAAK6H,KAEtBzI,EAAEgI,KAAKvG,GAAGqF,YAAY,QAAU7G,EAAIC,WAAWG,QAAU,mBACrD,CACIkK,cAAeA,EACf9B,KAAMA,IAEV,SAAmB1B,GACXA,EAASpD,MACT1D,EAAIC,WAAWmC,YAAY0E,EAASpD,MAAO,SAI/C1D,EAAIC,WAAWyE,UAAU6F,iBAAiBzD,EAC9C,GACR,EAEA9G,EAAIC,WAAWkF,cAAgB,SAAUrB,GACrC,IAAIhD,EAAYgD,EAAMnD,KAAK6H,KACvBjI,EAASuD,EAAMnD,KAAK2J,cAAcE,QAClCC,EAAa3G,EAAMnD,KAAK8J,WACxBC,EAAYlJ,GAAGqF,YAAY,QAAQ7G,EAAIC,WAAWG,WAAWG,cAAmBiB,GAAGmJ,WAAW7J,MAClGQ,OAAOsJ,KAAKF,EAAWD,EAC3B,EAEAzK,EAAIC,WAAWmF,yBAA2B,SAAUtB,GAChD,IAAI+G,EAAuB,CACvB,qEAEA7K,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,+BACRC,MAAOkE,GAEX,KAEArJ,GAAGkG,QAAQC,WAAWtF,EAAErC,EAAIC,WAAWG,QAAS,sBAC5CJ,EAAIC,WAAWsI,uBACf,EACAsC,GACA,EAEZ,EAEA7K,EAAIC,WAAWoF,aAAe,SAAUvB,QACRgH,IAAxBhH,EAAMnD,KAAKoK,UACXhL,EAAEiD,KAAK,CACHC,IAAKzB,GAAGqF,YAAY,0BAA4BrF,GAAGmJ,WAAW3K,EAAIC,WAAWa,WAC7EuC,KAAM,OACN1C,KAAM4I,KAAKC,UAAU,CACjBwB,KAAMlH,EAAMnD,KAAKoK,SAAW,CAACvJ,GAAGyJ,cAAgB,KAEpDC,YAAa,mBACbC,SAAU,OACVjI,QAAS,WACLlD,EAAIC,WAAWyE,UAAU0G,YAAYtH,EAAMnD,KAAKoK,SACpD,GAGZ,EAEA/K,EAAIC,WAAWmC,YAAc,SAAUgI,EAAS/G,EAAO,UAAWgI,EAAQ,MAKtE,GAJIrL,EAAIC,WAAW2F,cACf5F,EAAIC,WAAW2F,aAAaU,SAG5BtG,EAAIC,WAAWI,QACfiB,OAAOK,OAAO8E,YAAY,CACtBC,OAAQ,gBACRC,MAAO,CACHyD,QAASA,EACT/G,KAAMA,EACNgI,MAAOA,IAGf,UAIJ,OAAQhI,GACJ,IAAK,UACD4F,IAAIC,MAAMhG,QAAQkH,EAASiB,GAC3B,MACJ,IAAK,QACDpC,IAAIC,MAAMxF,MAAM0G,EAASiB,GAGrC,EAEArL,EAAIC,WAAW8G,eAAiB,SAAUD,EAAU5E,GAChD,GAAI4E,EAASpD,MACT,IAAI/C,EAAO,CAAC+C,MAAOoD,EAASpD,WACzB,CACH,IAAI4H,EAAiB,EACrBvL,EAAEwL,KAAKzE,GAAU,SAAU0E,EAAGC,GACtBA,EAAYvJ,SAAWoJ,IACvBA,EAAiBG,EAAYvJ,SAGjCuJ,EAAYC,QAAUC,OAA6B,IAAtBF,EAAYC,SAAgBE,OAAO,SAC5DH,EAAYI,SACZ9L,EAAEwL,KAAKE,EAAYI,SAAS,SAAUC,EAAGC,GACrCA,EAAOL,QAAUC,OAAOI,EAAOL,QAAU,UAAUE,OAAO,QAC9D,GAER,IAEI1J,IACAoJ,EAAiBU,KAAKC,IAAIX,EAAgBpJ,IAG9CvB,EAAO,CACH2K,eAAgBA,EAChBY,QAASpF,EAEjB,CACA9G,EAAIC,WAAWyE,UAAUqC,eAAepG,EAC5C,EAEAX,EAAIC,WAAWiH,OAAS,WACpB,GAA8B,WAA1BlH,EAAIC,WAAWmD,OAAnB,CAIA,IAAI+I,EAAepM,EAAE,WAAW+C,OAAS,EAAI/C,EAAE,WAAWqM,SAAW,GACjEC,EAAStM,EAAE,eACXsM,EAAOvJ,OAAS,IAChBuJ,EAAO,GAAGC,MAAMF,OAAUG,OAAOC,YAAcL,EAAgB,KAC/D7K,OAAOmL,SAAS,GAAI,GACpBJ,EAAO,GAAGC,MAAMF,OAAU9K,OAAOoL,IAAIC,YAAcR,EAAgB,KAPvE,CASJ,EAEAnM,EAAIC,WAAWqD,aAAe,WACtBhC,OAAOsL,mBACH,WAAWlD,KAAKmD,UAAUC,YAC1BxL,OAAOsL,iBAAiB,SAAU5M,EAAIC,WAAWiH,QAEjD,oBAAoBwC,KAAKmD,UAAUC,YACnCxL,OAAOsL,iBAAiB,oBAAqB5M,EAAIC,WAAWiH,QAGxE,EAEAlH,EAAIC,WAAWkH,YAAc,WACzBtF,SAASkL,cAAc,yBAAyBC,aAAa,UAAU,4EAC3E,EAEAhN,EAAIC,WAAWS,YAElB,CAtuBD,CAsuBGuM,OAAQjN","sources":["webpack:///onlyoffice/src/editor.js"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2024\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n(function ($, OCA) {\n\n    OCA.Onlyoffice = _.extend({\n            AppName: \"onlyoffice\",\n            inframe: false,\n            inviewer: false,\n            fileId: null,\n            shareToken: null,\n            insertImageType: null\n        }, OCA.Onlyoffice);\n\n    OCA.Onlyoffice.InitEditor = function () {\n\n        OCA.Onlyoffice.fileId = $(\"#iframeEditor\").data(\"id\");\n        OCA.Onlyoffice.shareToken = $(\"#iframeEditor\").data(\"sharetoken\");\n        var directToken = $(\"#iframeEditor\").data(\"directtoken\");\n        OCA.Onlyoffice.template = $(\"#iframeEditor\").data(\"template\");\n        OCA.Onlyoffice.inframe = !!$(\"#iframeEditor\").data(\"inframe\");\n        OCA.Onlyoffice.inviewer = !!$(\"#iframeEditor\").data(\"inviewer\");\n        OCA.Onlyoffice.filePath = $(\"#iframeEditor\").data(\"path\");\n        OCA.Onlyoffice.anchor = $(\"#iframeEditor\").attr(\"data-anchor\");\n        OCA.Onlyoffice.forceEdit = $(\"#iframeEditor\").attr(\"data-forceEdit\");\n        var guestName = localStorage.getItem(\"nick\");\n        OCA.Onlyoffice.currentWindow = window;\n        OCA.Onlyoffice.currentUser = OC.getCurrentUser();\n\n        if (OCA.Onlyoffice.inframe) {\n            OCA.Onlyoffice.faviconBase = $('link[rel=\"icon\"]').attr(\"href\");\n            OCA.Onlyoffice.currentWindow = window.parent;\n            OCA.Onlyoffice.titleBase = OCA.Onlyoffice.currentWindow.document.title;\n            OCA.Onlyoffice.currentUser = OCA.Onlyoffice.currentWindow.OC.getCurrentUser();\n        }\n\n        if (!OCA.Onlyoffice.fileId && !OCA.Onlyoffice.shareToken && !directToken) {\n            OCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, \"FileId is empty\"), \"error\", {timeout: -1});\n            return;\n        }\n\n        if (typeof DocsAPI === \"undefined\") {\n            OCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, \"ONLYOFFICE cannot be reached. Please contact admin\"), \"error\", {timeout: -1});\n            return;\n        }\n\n        var docsVersion = DocsAPI.DocEditor.version().split(\".\");\n        if (docsVersion[0] < 6\n            || docsVersion[0] == 6 && docsVersion[1] == 0) {\n            OCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, \"Not supported version\"), \"error\", {timeout: -1});\n            return;\n        }\n\n        var configUrl = OC.linkToOCS(\"apps/\" + OCA.Onlyoffice.AppName + \"/api/v1/config\", 2) + (OCA.Onlyoffice.fileId || 0);\n\n        var params = [];\n        var filePath = $(\"#iframeEditor\").data(\"path\");\n        if (filePath) {\n            params.push(\"filePath=\" + encodeURIComponent(filePath));\n        }\n        if (OCA.Onlyoffice.shareToken) {\n            params.push(\"shareToken=\" + encodeURIComponent(OCA.Onlyoffice.shareToken));\n        }\n        if (directToken) {\n            $(\"html\").addClass(\"onlyoffice-full-page\");\n            params.push(\"directToken=\" + encodeURIComponent(directToken));\n        }\n        if (OCA.Onlyoffice.template) {\n            params.push(\"template=true\");\n        }\n        if (guestName && guestName !== \"null\") {\n            params.push(\"guestName=\" + encodeURIComponent(guestName));\n        }\n        if (OCA.Onlyoffice.anchor) {\n            params.push(\"anchor=\" + encodeURIComponent(OCA.Onlyoffice.anchor));\n        }\n        if (OCA.Onlyoffice.forceEdit) {\n            params.push(\"forceEdit=true\");\n        }\n\n        if (OCA.Onlyoffice.inframe || directToken) {\n            params.push(\"inframe=true\");\n        }\n\n        if (OCA.Onlyoffice.inviewer) {\n            params.push(\"inviewer=true\");\n        }\n\n        if (OCA.Onlyoffice.Desktop) {\n            params.push(\"desktop=true\");\n        }\n        if (params.length) {\n            configUrl += \"?\" + params.join(\"&\");\n        }\n\n        $.ajax({\n            url: configUrl,\n            success: function onSuccess(config) {\n                if (config) {\n                    OCA.Onlyoffice.device = config.type;\n                    if (OCA.Onlyoffice.device === \"mobile\") {\n                        OCA.Onlyoffice.resizeEvents();\n                    }\n\n                    if (config.redirectUrl) {\n                        location.href = config.redirectUrl;\n                        return;\n                    }\n\n                    if (config.error != null) {\n                        OCA.Onlyoffice.showMessage(config.error, \"error\", {timeout: -1});\n                        return;\n                    }\n\n                    var docIsChanged = null;\n                    var docIsChangedTimeout = null;\n\n                    var setPageTitle = function (event) {\n                        clearTimeout(docIsChangedTimeout);\n\n                        if (docIsChanged !== event.data) {\n                            var titleChange = function () {\n                                OCA.Onlyoffice.currentWindow.document.title = config.document.title + (event.data ? \" *\" : \"\") + \" - \" + oc_defaults.title;\n                                docIsChanged = event.data;\n                            };\n\n                            if (event === false || event.data) {\n                                titleChange();\n                            } else {\n                                docIsChangedTimeout = setTimeout(titleChange, 500);\n                            }\n                        }\n                    };\n                    setPageTitle(false);\n\n                    OCA.Onlyoffice.documentType = config.documentType;\n\n                    config.events = {\n                        \"onDocumentStateChange\": setPageTitle,\n                        \"onDocumentReady\": OCA.Onlyoffice.onDocumentReady,\n                        \"onMakeActionLink\": OCA.Onlyoffice.onMakeActionLink,\n                    };\n\n                    if (config.editorConfig.tenant) {\n                        config.events.onAppReady = function () {\n                            OCA.Onlyoffice.docEditor.showMessage(t(OCA.Onlyoffice.AppName, \"You are using public demo ONLYOFFICE Docs server. Please do not store private sensitive data.\"));\n                        };\n                    }\n\n                    if (OCA.Onlyoffice.inframe && !OCA.Onlyoffice.shareToken\n                        || OCA.Onlyoffice.currentUser.uid) {\n                        config.events.onRequestSaveAs = OCA.Onlyoffice.onRequestSaveAs;\n                        config.events.onRequestInsertImage = OCA.Onlyoffice.onRequestInsertImage;\n                        config.events.onRequestMailMergeRecipients = OCA.Onlyoffice.onRequestMailMergeRecipients;\n                        config.events.onRequestCompareFile = OCA.Onlyoffice.onRequestSelectDocument; //todo: remove (for editors 7.4)\n                        config.events.onRequestSelectDocument = OCA.Onlyoffice.onRequestSelectDocument;\n                        config.events.onRequestSendNotify = OCA.Onlyoffice.onRequestSendNotify;\n                        config.events.onRequestReferenceData = OCA.Onlyoffice.onRequestReferenceData;\n                        config.events.onRequestOpen = OCA.Onlyoffice.onRequestOpen;\n                        config.events.onRequestReferenceSource = OCA.Onlyoffice.onRequestReferenceSource;\n                        config.events.onMetaChange = OCA.Onlyoffice.onMetaChange;\n\n                        if (OCA.Onlyoffice.currentUser.uid) {\n                            config.events.onRequestUsers = OCA.Onlyoffice.onRequestUsers;\n                        }\n\n                        if (!OCA.Onlyoffice.filePath) {\n                            OCA.Onlyoffice.filePath = config._file_path;\n                        }\n\n                        if (!OCA.Onlyoffice.template) {\n                            config.events.onRequestHistory = OCA.Onlyoffice.onRequestHistory;\n                            config.events.onRequestHistoryData = OCA.Onlyoffice.onRequestHistoryData;\n                            config.events.onRequestRestore = OCA.Onlyoffice.onRequestRestore;\n                            config.events.onRequestHistoryClose = OCA.Onlyoffice.onRequestHistoryClose;\n                        }\n                    }\n\n                    if (OCA.Onlyoffice.directEditor || OCA.Onlyoffice.inframe) {\n                        config.events.onRequestClose = OCA.Onlyoffice.onRequestClose;\n                    }\n\n                    if (OCA.Onlyoffice.inframe\n                        && config._files_sharing && !OCA.Onlyoffice.shareToken\n                        && window.parent.OCA.Onlyoffice.context) {\n                        config.events.onRequestSharingSettings = OCA.Onlyoffice.onRequestSharingSettings;\n                    }\n\n                    if (!config.document.permissions.edit\n                        && config.document.permissions.fillForms\n                        && config.canEdit) {\n                        config.events.onRequestEditRights = OCA.Onlyoffice.onRequestEditRights;\n                    }\n\n                    OCA.Onlyoffice.docEditor = new DocsAPI.DocEditor(\"iframeEditor\", config);\n\n                    if (OCA.Onlyoffice.directEditor) {\n                        OCA.Onlyoffice.directEditor.loaded();\n                    }\n\n                    if (!OCA.Onlyoffice.directEditor\n                        && config.type === \"mobile\" && $(\"#app > iframe\").css(\"position\") === \"fixed\") {\n                        $(\"#app > iframe\").css(\"height\", \"calc(100% - 50px)\");\n                    }\n\n                    var favicon = OC.filePath(OCA.Onlyoffice.AppName, \"img\", OCA.Onlyoffice.documentType + \".ico\");\n                    if (OCA.Onlyoffice.inframe) {\n                        window.parent.postMessage({\n                            method: \"changeFavicon\",\n                            param: favicon\n                        },\n                        \"*\");\n                    } else {\n                        $('link[rel=\"icon\"]').attr(\"href\", favicon);\n                    }\n                }\n            }\n        });\n    };\n\n    OCA.Onlyoffice.onRequestEditRights = function () {\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"onRequestEditRights\"\n            },\n            \"*\");\n            return;\n        }\n        location.href += \"&forceEdit=true\";\n    };\n\n    OCA.Onlyoffice.onRequestHistory = function (version) {\n        $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/history?fileId={fileId}\",\n            {\n                fileId: OCA.Onlyoffice.fileId || 0,\n            }),\n            function onSuccess(response) {\n                OCA.Onlyoffice.refreshHistory(response, version);\n        });\n    };\n\n    OCA.Onlyoffice.onRequestHistoryData = function (event) {\n        var version = event.data;\n\n        $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/version?fileId={fileId}&version={version}\",\n            {\n                fileId: OCA.Onlyoffice.fileId || 0,\n                version: version,\n            }),\n            function onSuccess(response) {\n                if (response.error) {\n                    response = {\n                        error: response.error,\n                        version: version,\n                    };\n                }\n                OCA.Onlyoffice.docEditor.setHistoryData(response);\n        });\n    };\n\n    OCA.Onlyoffice.onRequestRestore = function (event) {\n        var version = event.data.version;\n\n        $.ajax({\n            method: \"PUT\",\n            url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/restore\"),\n            data: {\n                fileId: OCA.Onlyoffice.fileId || 0,\n                version: version,\n            },\n            success: function onSuccess(response) {\n                OCA.Onlyoffice.refreshHistory(response, version);\n\n                if (OCA.Onlyoffice.inframe) {\n                    window.parent.postMessage({\n                        method: \"onRefreshVersionsDialog\"\n                    },\n                    \"*\");\n                }\n            }\n        });\n    };\n\n    OCA.Onlyoffice.onRequestHistoryClose = function () {\n        location.reload(true);\n    };\n\n    OCA.Onlyoffice.onDocumentReady = function() {\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"onDocumentReady\",\n                param: {}\n            },\n            \"*\");\n        }\n\n        OCA.Onlyoffice.resize();\n        OCA.Onlyoffice.setViewport();\n    };\n\n    OCA.Onlyoffice.onRequestSaveAs = function (event) {\n        var saveData = {\n            name: event.data.title,\n            url: event.data.url\n        };\n\n        if (OCA.Onlyoffice.filePath) {\n            var arrayPath = OCA.Onlyoffice.filePath.split(\"/\");\n            arrayPath.pop();\n            arrayPath.shift();\n            saveData.dir = \"/\" + arrayPath.join(\"/\");\n        }\n\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"editorRequestSaveAs\",\n                param: saveData\n            },\n            \"*\");\n        } else {\n            OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Save as\"),\n                function (fileDir) {\n                    saveData.dir = fileDir;\n                    OCA.Onlyoffice.editorSaveAs(saveData);\n                },\n                false,\n                \"httpd/unix-directory\",\n                true,\n                OC.dialogs.FILEPICKER_TYPE_CHOOSE,\n                saveData.dir);\n        }\n    };\n\n    OCA.Onlyoffice.editorSaveAs = function (saveData) {\n        $.post(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/save\"),\n            saveData,\n            function onSuccess(response) {\n                if (response.error) {\n                    OCA.Onlyoffice.showMessage(response.error, \"error\");\n                    return;\n                }\n\n                OCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, \"File saved\") + \" (\" + response.name + \")\");\n            });\n    };\n\n    OCA.Onlyoffice.onRequestInsertImage = function (event) {\n        var imageMimes = [\n            \"image/bmp\", \"image/x-bmp\", \"image/x-bitmap\", \"application/bmp\",\n            \"image/gif\",\n            \"image/jpeg\", \"image/jpg\", \"application/jpg\", \"application/x-jpg\",\n            \"image/png\", \"image/x-png\", \"application/png\", \"application/x-png\"\n        ];\n\n        if (event.data) {\n            OCA.Onlyoffice.insertImageType = event.data.c;\n        }\n\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"editorRequestInsertImage\",\n                param: imageMimes\n            },\n            \"*\");\n        } else {\n            OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Insert image\"),\n                OCA.Onlyoffice.editorInsertImage,\n                false,\n                imageMimes,\n                true);\n        }\n    };\n\n    OCA.Onlyoffice.editorInsertImage = function (filePath) {\n        $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/url?filePath={filePath}\",\n            {\n                filePath: filePath\n            }),\n            function onSuccess(response) {\n                if (response.error) {\n                    OCA.Onlyoffice.showMessage(response.error, \"error\");\n                    return;\n                }\n\n                if (OCA.Onlyoffice.insertImageType) {\n                    response.c = OCA.Onlyoffice.insertImageType;\n                }\n\n                OCA.Onlyoffice.docEditor.insertImage(response);\n            });\n    };\n\n    OCA.Onlyoffice.onRequestMailMergeRecipients = function () {\n        var recipientMimes = [\n            \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n        ];\n\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"editorRequestMailMergeRecipients\",\n                param: recipientMimes\n            },\n            \"*\");\n        } else {\n            OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Select recipients\"),\n                OCA.Onlyoffice.editorSetRecipient,\n                false,\n                recipientMimes,\n                true);\n        }\n    };\n\n    OCA.Onlyoffice.editorSetRecipient = function (filePath) {\n        $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/url?filePath={filePath}\",\n            {\n                filePath: filePath\n            }),\n            function onSuccess(response) {\n                if (response.error) {\n                    OCA.Onlyoffice.showMessage(response.error, \"error\");\n                    return;\n                }\n\n                OCA.Onlyoffice.docEditor.setMailMergeRecipients(response);\n            });\n    };\n\n    OCA.Onlyoffice.editorReferenceSource = function (filePath) {\n        if (filePath === OCA.Onlyoffice.filePath) {\n            OCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, \"The data source must not be the current document\"), \"error\");\n            return;\n        }\n\n        $.post(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/reference\"),\n        {\n            path: filePath\n        },\n        function onSuccess(response) {\n            if (response.error) {\n                OCA.Onlyoffice.showMessage(response.error, \"error\");\n                return;\n            }\n            OCA.Onlyoffice.docEditor.setReferenceSource(response);\n        });\n    }\n\n    OCA.Onlyoffice.onRequestClose = function () {\n        if (OCA.Onlyoffice.directEditor) {\n            OCA.Onlyoffice.directEditor.close();\n            return;\n        }\n\n        OCA.Onlyoffice.docEditor.destroyEditor();\n\n        window.parent.postMessage({\n            method: \"editorRequestClose\"\n        },\n        \"*\");\n    };\n\n    OCA.Onlyoffice.onRequestSharingSettings = function () {\n        window.parent.postMessage({\n            method: \"editorRequestSharingSettings\"\n        },\n        \"*\");\n    };\n\n    OCA.Onlyoffice.onRequestSelectDocument = function (event) {\n        var revisedMimes = [\n            \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n        ];\n\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"editorRequestSelectDocument\",\n                param: revisedMimes,\n                documentSelectionType: event.data.c\n            },\n            \"*\");\n        } else {\n            switch (event.data.c) {\n                case \"combine\":\n                    var title =  t(OCA.Onlyoffice.AppName, \"Select file to combine\");\n                    break;\n                default:\n                    title =  t(OCA.Onlyoffice.AppName, \"Select file to compare\");\n            }\n            OC.dialogs.filepicker(title,\n                OCA.Onlyoffice.editorSetRequested.bind({documentSelectionType: event.data.c}),\n                false,\n                revisedMimes,\n                true);\n        }\n    };\n\n    OCA.Onlyoffice.editorSetRequested = function (filePath) {\n        let documentSelectionType = this.documentSelectionType;\n        $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/url?filePath={filePath}\",\n            {\n                filePath: filePath\n            }),\n            function onSuccess(response) {\n                if (response.error) {\n                    OCP.Toast.error(response.error);\n                    return;\n                }\n                response.c = documentSelectionType;\n\n                OCA.Onlyoffice.docEditor.setRequestedDocument(response);\n            });\n    };\n\n    OCA.Onlyoffice.onMakeActionLink = function (event) {\n        var url = location.href;\n        if (event && event.data) {\n            var indexAnchor = url.indexOf(\"#\");\n            if (indexAnchor != -1) {\n                url = url.substring(0, indexAnchor);\n            }\n\n            var data = JSON.stringify(event.data);\n            data = \"anchor=\" + encodeURIComponent(data);\n\n            var inframeRegex = /inframe=([^&]*&?)/g;\n            if (inframeRegex.test(url)) {\n                url = url.replace(inframeRegex, data);\n            }\n\n            var anchorRegex = /anchor=([^&]*)/g;\n            if (anchorRegex.test(url)) {\n                url = url.replace(anchorRegex, data);\n            } else {\n                url += (url.indexOf(\"?\") == -1) ? \"?\" : \"&\";\n                url += data;\n            }\n        }\n\n        OCA.Onlyoffice.docEditor.setActionLink(url);\n    };\n\n    OCA.Onlyoffice.onRequestUsers = function (event) {\n        let operationType = typeof(event.data.c) !== \"undefined\" ? event.data.c : null;\n        switch (operationType) {\n            case \"info\":\n                    $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/userInfo?userIds={userIds}\",\n                    {\n                        userIds: JSON.stringify(event.data.id)\n                    }),\n                    function onSuccess(response) {\n                        OCA.Onlyoffice.docEditor.setUsers({\n                            \"c\": operationType,\n                            \"users\": response\n                        });\n                    });\n                break;\n                default:\n                    $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/users?fileId={fileId}&operationType=\" + operationType,\n                    {\n                        fileId: OCA.Onlyoffice.fileId || 0\n                    }),\n                    function onSuccess(response) {\n                        OCA.Onlyoffice.docEditor.setUsers({\n                            \"c\": operationType,\n                            \"users\": response\n                        });\n                    });\n        }\n    };\n\n    OCA.Onlyoffice.onRequestSendNotify = function (event) {\n        var actionLink = event.data.actionLink;\n        var comment = event.data.message;\n        var emails = event.data.emails;\n\n        var fileId = OCA.Onlyoffice.fileId;\n\n        $.post(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/mention\"),\n            {\n                fileId: fileId,\n                anchor: JSON.stringify(actionLink),\n                comment: comment,\n                emails: emails\n            },\n            function onSuccess(response) {\n                if (response.error) {\n                    OCA.Onlyoffice.showMessage(response.error, \"error\");\n                    return;\n                }\n\n                OCA.Onlyoffice.showMessage(response.message);\n            });\n    };\n\n    OCA.Onlyoffice.onRequestReferenceData = function (event) {\n        let referenceData = event.data.referenceData;\n        let path = event.data.path;\n\n        $.post(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/reference\"),\n            {\n                referenceData: referenceData,\n                path: path\n            },\n            function onSuccess(response) {\n                if (response.error) {\n                    OCA.Onlyoffice.showMessage(response.error, \"error\");\n                    return;\n                }\n\n                OCA.Onlyoffice.docEditor.setReferenceData(response);\n            });\n    };\n\n    OCA.Onlyoffice.onRequestOpen = function (event) {\n        let filePath  = event.data.path;\n        let fileId = event.data.referenceData.fileKey;\n        let windowName = event.data.windowName;\n        let sourceUrl = OC.generateUrl(`apps/${OCA.Onlyoffice.AppName}/${fileId}?filePath=${OC.encodePath(filePath)}`);\n        window.open(sourceUrl, windowName);\n    };\n\n    OCA.Onlyoffice.onRequestReferenceSource = function (event) {\n        let referenceSourceMimes = [\n            \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n        ];\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"editorRequestReferenceSource\",\n                param: referenceSourceMimes\n            },\n            \"*\");\n        } else {\n            OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Select data source\"),\n                OCA.Onlyoffice.editorReferenceSource,\n                false,\n                referenceSourceMimes,\n                true);\n        }\n    };\n\n    OCA.Onlyoffice.onMetaChange = function (event) {\n        if (event.data.favorite !== undefined) {\n            $.ajax({\n                url: OC.generateUrl(\"apps/files/api/v1/files\" + OC.encodePath(OCA.Onlyoffice.filePath)),\n                type: \"post\",\n                data: JSON.stringify({\n                    tags: event.data.favorite ? [OC.TAG_FAVORITE] : []\n                }),\n                contentType: \"application/json\",\n                dataType: \"json\",\n                success: function(){\n                    OCA.Onlyoffice.docEditor.setFavorite(event.data.favorite);\n                }\n            });\n        }\n    }\n\n    OCA.Onlyoffice.showMessage = function (message, type = \"success\", props = null) {\n        if (OCA.Onlyoffice.directEditor) {\n            OCA.Onlyoffice.directEditor.loaded();\n        }\n\n        if (OCA.Onlyoffice.inframe) {\n            window.parent.postMessage({\n                method: \"onShowMessage\",\n                param: {\n                    message: message,\n                    type: type,\n                    props: props\n                }\n            },\n            \"*\");\n            return;\n        }\n\n        switch (type) {\n            case \"success\":\n                OCP.Toast.success(message, props);\n                break;\n            case \"error\":\n                OCP.Toast.error(message, props);\n                break;\n        }\n    };\n\n    OCA.Onlyoffice.refreshHistory = function (response, version) {\n        if (response.error) {\n            var data = {error: response.error};\n        } else {\n            var currentVersion = 0;\n            $.each(response, function (i, fileVersion) {\n                if (fileVersion.version >= currentVersion) {\n                    currentVersion = fileVersion.version;\n                }\n\n                fileVersion.created = moment(fileVersion.created * 1000).format(\"L LTS\");\n                if (fileVersion.changes) {\n                    $.each(fileVersion.changes, function (j, change) {\n                        change.created = moment(change.created + \"+00:00\").format(\"L LTS\");\n                    });\n                }\n            });\n\n            if (version) {\n                currentVersion = Math.min(currentVersion, version);\n            }\n\n            data = {\n                currentVersion: currentVersion,\n                history: response,\n            };\n        }\n        OCA.Onlyoffice.docEditor.refreshHistory(data);\n    }\n\n    OCA.Onlyoffice.resize = function () {\n        if (OCA.Onlyoffice.device !== \"mobile\") {\n            return;\n        }\n\n        var headerHeight = $(\"#header\").length > 0 ? $(\"#header\").height() : 50;\n        var wrapEl = $(\"#app>iframe\");\n        if (wrapEl.length > 0) {\n            wrapEl[0].style.height = (screen.availHeight - headerHeight) + \"px\";\n            window.scrollTo(0, -1);\n            wrapEl[0].style.height = (window.top.innerHeight - headerHeight) + \"px\";\n        }\n    };\n\n    OCA.Onlyoffice.resizeEvents = function() {\n        if (window.addEventListener) {\n            if (/Android/i.test(navigator.userAgent)) {\n                window.addEventListener(\"resize\", OCA.Onlyoffice.resize);\n            }\n            if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {\n                window.addEventListener(\"orientationchange\", OCA.Onlyoffice.resize);\n            }\n        }\n    };\n\n    OCA.Onlyoffice.setViewport = function() {\n        document.querySelector('meta[name=\"viewport\"]').setAttribute(\"content\",\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0\");\n    };\n\n    OCA.Onlyoffice.InitEditor();\n\n})(jQuery, OCA);\n"],"names":["$","OCA","Onlyoffice","_","extend","AppName","inframe","inviewer","fileId","shareToken","insertImageType","InitEditor","data","directToken","template","filePath","anchor","attr","forceEdit","guestName","localStorage","getItem","currentWindow","window","currentUser","OC","getCurrentUser","faviconBase","parent","titleBase","document","title","DocsAPI","docsVersion","DocEditor","version","split","showMessage","t","timeout","configUrl","linkToOCS","params","push","encodeURIComponent","addClass","Desktop","length","join","ajax","url","success","config","device","type","resizeEvents","redirectUrl","location","href","error","docIsChanged","docIsChangedTimeout","setPageTitle","event","clearTimeout","titleChange","oc_defaults","setTimeout","documentType","events","onDocumentReady","onMakeActionLink","editorConfig","tenant","onAppReady","docEditor","uid","onRequestSaveAs","onRequestInsertImage","onRequestMailMergeRecipients","onRequestCompareFile","onRequestSelectDocument","onRequestSendNotify","onRequestReferenceData","onRequestOpen","onRequestReferenceSource","onMetaChange","onRequestUsers","_file_path","onRequestHistory","onRequestHistoryData","onRequestRestore","onRequestHistoryClose","directEditor","onRequestClose","_files_sharing","context","onRequestSharingSettings","permissions","edit","fillForms","canEdit","onRequestEditRights","loaded","css","favicon","postMessage","method","param","get","generateUrl","response","refreshHistory","setHistoryData","reload","resize","setViewport","saveData","name","arrayPath","pop","shift","dir","dialogs","filepicker","fileDir","editorSaveAs","FILEPICKER_TYPE_CHOOSE","post","imageMimes","c","editorInsertImage","insertImage","recipientMimes","editorSetRecipient","setMailMergeRecipients","editorReferenceSource","path","setReferenceSource","close","destroyEditor","revisedMimes","documentSelectionType","editorSetRequested","bind","this","OCP","Toast","setRequestedDocument","indexAnchor","indexOf","substring","JSON","stringify","inframeRegex","test","replace","anchorRegex","setActionLink","operationType","userIds","id","setUsers","actionLink","comment","message","emails","referenceData","setReferenceData","fileKey","windowName","sourceUrl","encodePath","open","referenceSourceMimes","undefined","favorite","tags","TAG_FAVORITE","contentType","dataType","setFavorite","props","currentVersion","each","i","fileVersion","created","moment","format","changes","j","change","Math","min","history","headerHeight","height","wrapEl","style","screen","availHeight","scrollTo","top","innerHeight","addEventListener","navigator","userAgent","querySelector","setAttribute","jQuery"],"sourceRoot":""}