{"version":3,"file":"onlyoffice-settings.js?v=35550f8cad333ef3894c","mappings":"CA4BA,SAAWA,EAAGC,GAEVD,EAAEE,UAAUC,OAAM,WACdC,IAAIC,WAAaC,EAAEC,OAAO,CAAC,EAAGH,IAAIC,YAC7BD,IAAIC,WAAWG,UAChBJ,IAAIC,WAAa,CACbG,QAAS,eAIjB,IAAIC,EAAY,WACZT,EAAE,0BAA0BU,YAAY,mBACxCV,EAAE,wBAAwBU,YAAY,kCAC1C,GAEIV,EAAE,0BAA0BW,MAAMC,QAC/BZ,EAAE,yBAAyBW,MAAMC,QACjCZ,EAAE,wBAAwBW,MAAMC,SACnCH,IAGJT,EAAE,kBAAkBa,MAAMJ,GAE1BT,EAAE,qBAAqBc,KAAK,UAAgD,IAArCd,EAAE,0BAA0BW,OAEnE,IAAII,EAAkB,WACdf,EAAE,qBAAqBc,KAAK,WAC5Bb,EAAGe,SAASC,kBAAkBjB,EAAE,2BAEhCA,EAAE,0BAA0BkB,QAAQ,UAE5C,EAEAlB,EAAE,qBAAqBa,MAAME,GAC7BA,IAEA,IAAII,EAAa,WACbnB,EAAE,4DAA4Dc,KAAK,WAAYd,EAAE,mBAAmBc,KAAK,WAC7G,EAEAd,EAAE,mBAAmBa,MAAMM,GAC3BA,IAMAnB,EAAE,gCAAgCa,OAJZ,WAClBb,EAAE,gCAAgCU,YAAY,mBAAoBV,EAAE,gCAAgCc,KAAK,WAC7G,IAIAd,EAAE,iCAAiCa,OAAM,WACrCb,EAAE,kCAAkCoB,SAASV,YAAY,kBAC7D,IAEAV,EAAE,gCAAgCa,OAAM,WACpCb,EAAE,uCAAuCU,YAAY,kBACzD,IAEA,IAAIW,EAAsB,CACtB,aAGAC,EAAoB,CACpB,UACA,YAGAC,EAAyB,SAAUC,GACnC,IAAIC,EAAsB,WAClBzB,EAAE,wBAA0BwB,GAAWV,KAAK,WACxCU,EAAUE,QAAQ,UAAY,EAC9BzB,EAAGe,SAASC,kBAAkBjB,EAAE,wBAA0BwB,EAAY,SAEtExB,EAAE,wBAA0BwB,EAAY,QAAQN,QAAQ,CACpDS,YAAY,EACZC,eAAe,EACfC,UAAU,EACVC,UAAW,IACXC,cAAc,EACdC,YAAaC,EAAE7B,IAAIC,WAAWG,QAAS,cACvC0B,MAAO5B,EAAE6B,UAAS,SAAUD,GACxBA,EAAME,SAAS,CACXC,QAASpC,EAAGqC,WAAWC,WAAWC,aAAaN,EAAMO,OAE7D,GAAG,KAAK,GACRC,cAAe,SAAUC,EAASP,GAI9BA,GAHiBpC,EAAE2C,GAAShC,OAAS,IAAIiC,MAAM,KAAKC,KAAI,SAAUC,GAC9D,OAAO7C,EAAGqC,WAAWC,WAAWQ,IAAID,EACxC,IAEJ,EACAE,aAAc,SAAUC,GACpB,OAAOhD,EAAGqC,WAAWY,kBAAkBD,EAC3C,EACAE,gBAAiB,SAAUF,GACvB,OAAOA,EAAIF,IAAI,OACnB,EACAK,YAAa,SAAUf,GAInB,OAHAA,EAAQgB,MAAK,SAAUC,EAAGC,GACtB,OAAOtD,EAAGuD,KAAKC,mBAAmBH,EAAEP,IAAI,QAASQ,EAAER,IAAI,QAC3D,IACOV,CACX,IAIRrC,EAAE,wBAA0BwB,EAAY,QAAQN,QAAQ,UAEhE,EAEAlB,EAAE,wBAA0BwB,GAAWX,MAAMY,GAC7CA,GACJ,EAEAzB,EAAE0D,KAAKrC,GAAqB,SAAUsC,EAAGC,GACrCrC,EAAuBqC,EAC3B,IAEI3D,EAAGqC,YAAcrC,EAAGqC,WAAWC,YAC/BtC,EAAGqC,WAAWC,WAAWsB,MAAM,CAC3BC,QAAS,WACL9D,EAAE0D,KAAKpC,GAAmB,SAAUqC,EAAGI,GACnCxC,EAAuBwC,EAC3B,GACJ,IAIR/D,EAAE,uBAAuBa,OAAM,WAC3Bb,EAAE,uBAAuBgE,SAAS,gBAClC,IAAIC,EAAgBjE,EAAE,kBAAkBW,MAAMuD,OAEzCD,EAAcrD,QACfZ,EAAE,0FAA0FW,IAAI,IAGpG,IAAIwD,GAAyBnE,EAAE,kCAAkCW,OAAS,IAAIuD,OAC1EE,GAAwBpE,EAAE,iCAAiCW,OAAS,IAAIuD,OACxEG,EAA0BrE,EAAE,4BAA4Bc,KAAK,WAC7DwD,GAAoBtE,EAAE,6BAA6BW,OAAS,IAAIuD,OAChEK,GAAavE,EAAE,gCAAgCW,OAAS,IAAIuD,OAC5DM,EAAOxE,EAAE,mBAAmBc,KAAK,WAErCd,EAAEyE,KAAK,CACHC,OAAQ,MACRC,IAAK1E,EAAG2E,YAAY,QAAUxE,IAAIC,WAAWG,QAAU,0BACvDqE,KAAM,CACFC,eAAgBb,EAChBc,uBAAwBZ,EACxBa,WAAYZ,EACZa,cAAeZ,EACfa,OAAQZ,EACRC,UAAWA,EACXC,KAAMA,GAEVV,QAAS,SAAmBqB,GAExB,GADAnF,EAAE,uBAAuBoF,YAAY,gBACjCD,IAAwC,MAA3BA,EAASL,gBAA0BN,GAAO,CACvDxE,EAAE,kBAAkBW,IAAIwE,EAASL,gBACjC9E,EAAE,0BAA0BW,IAAIwE,EAASJ,wBACzC/E,EAAE,yBAAyBW,IAAIwE,EAASH,YACxChF,EAAE,qBAAqBW,IAAIwE,EAASD,QACpClF,EAAE,wBAAwBW,IAAIwE,EAASZ,WAEvCvE,EAAE,4FAA4FU,YAAY,kBAA+C,MAA3ByE,EAASL,iBAA2BN,KAAWW,EAASE,MAAMzE,QAE5L,IAAI0E,EAAiBH,EAASI,QAAW,KAAOtD,EAAE7B,IAAIC,WAAWG,QAAS,WAAa,IAAM2E,EAASI,QAAU,IAAO,GAEnHJ,EAASE,MACTG,IAAIC,MAAMJ,MAAMpD,EAAE7B,IAAIC,WAAWG,QAAS,gCAAkC,KAAO2E,EAASE,MAAQ,IAAMC,GAE1GE,IAAIC,MAAM3B,QAAQ7B,EAAE7B,IAAIC,WAAWG,QAAS,2CAA6C8E,EAEjG,MACItF,EAAE,4FAA4FgE,SAAS,kBAE/G,GAER,IAEAhE,EAAE,mBAAmBa,OAAM,WACvBb,EAAE,uBAAuBgE,SAAS,gBAElC,IAAI0B,EAAa,CAAC,EAClB1F,EAAE,oCAAsC0D,MAAK,WACzCgC,EAAWC,KAAKC,MAAQD,KAAKE,OACjC,IAEA,IAAIC,EAAc,CAAC,EACnB9F,EAAE,qCAAuC0D,MAAK,WAC1CoC,EAAYH,KAAKC,MAAQD,KAAKE,OAClC,IAEA,IAAIE,EAAU/F,EAAE,sBAAsBgG,GAAG,YACrCC,EAAUjG,EAAE,sBAAsBgG,GAAG,YACrCE,EAAWlG,EAAE,uBAAuBgG,GAAG,YACvCG,EAAcnG,EAAE,0BAA0BgG,GAAG,YAC7CI,EAAiBpG,EAAE,6BAA6BgG,GAAG,YAEnDK,EAAoBrG,EAAE,qBAAqBc,KAAK,WAAad,EAAE,0BAA0BW,MAAQ,GACjG2F,EAAcD,EAAoBA,EAAkBzD,MAAM,KAAO,GAEjE2D,EAAOvG,EAAE,mBAAmBgG,GAAG,YAC/BQ,EAAgBxG,EAAE,4BAA4BgG,GAAG,YACjDS,EAAWzG,EAAE,uBAAuBgG,GAAG,YACvCU,EAAY1G,EAAE,wBAAwBgG,GAAG,YACzCW,EAAO3G,EAAE,mBAAmBgG,GAAG,YAC/BY,EAAgB5G,EAAE,4BAA4BgG,GAAG,YACjDa,EAAgB7G,EAAE,qDAAqD8G,KAAK,MAAMC,QAAQ,2BAA4B,IACtHC,EAAQhH,EAAE,6CAA6C8G,KAAK,MAAMC,QAAQ,mBAAoB,IAElG/G,EAAEyE,KAAK,CACHC,OAAQ,MACRC,IAAK1E,EAAG2E,YAAY,QAAUxE,IAAIC,WAAWG,QAAU,yBACvDqE,KAAM,CACFa,WAAYA,EACZI,YAAaA,EACbC,QAASA,EACTE,QAASA,EACTC,SAAUA,EACVC,YAAaA,EACbC,eAAgBA,EAChBE,YAAaA,EACbC,KAAMA,EACNC,cAAeA,EACfC,SAAUA,EACVC,UAAWA,EACXC,KAAMA,EACNC,cAAeA,EACfC,cAAeA,EACfG,MAAOA,GAEXlD,QAAS,SAAmBqB,GACxBnF,EAAE,uBAAuBoF,YAAY,gBACjCD,GACAK,IAAIC,MAAM3B,QAAQ7B,EAAE7B,IAAIC,WAAWG,QAAS,2CAEpD,GAER,IAEAR,EAAE,2BAA2Ba,OAAM,WAC/Bb,EAAE,uBAAuBgE,SAAS,gBAElC,IAAIiD,EAAUjH,EAAE,sBAAsBgG,GAAG,YACrCkB,EAASlH,EAAE,qBAAqBgG,GAAG,YACnCmB,EAAanH,EAAE,kDAAkD8G,KAAK,MAAMC,QAAQ,wBAAyB,IAE7GK,EAAoB,CACpBC,QAASrH,EAAE,gCAAgCgG,GAAG,aAE9CoB,EAAkBC,UAClBD,EAAkBE,MAAQtH,EAAE,6BAA6BW,OAAS,IAAIuD,OAYtElE,EAAE0D,KAVoB,CAClB,YACA,UACA,UACA,WACA,aACA,WACA,WACA,cAEoB,SAAUC,EAAG4D,GACjCH,EAAkBG,GAAkBvH,EAAE,wBAA0BuH,GAAgBvB,GAAG,WACvF,IAEAhG,EAAE0D,KAAKrC,EAAoBmG,OAAOlG,IAAoB,SAAUqC,EAAG8D,GAC/D,IAAIC,EAAO1H,EAAE,wBAA0ByH,GAAezB,GAAG,YAAchG,EAAE,wBAA0ByH,EAAgB,QAAQ9G,MAAQ,GACnIyG,EAAkBK,EAAgB,QAAUC,EAAOA,EAAK9E,MAAM,KAAO,EACzE,KAGJ5C,EAAEyE,KAAK,CACHC,OAAQ,MACRC,IAAK1E,EAAG2E,YAAY,QAAUxE,IAAIC,WAAWG,QAAU,2BACvDqE,KAAM,CACF8C,WAAYP,EACZH,QAASA,EACTC,OAAQA,EACRC,WAAYA,GAEhBrD,QAAS,SAAmBqB,GACxBnF,EAAE,uBAAuBoF,YAAY,gBACjCD,GACAK,IAAIC,MAAM3B,QAAQ7B,EAAE7B,IAAIC,WAAWG,QAAS,2CAEpD,GAER,IAEAR,EAAE,kCAAkC4H,UAAS,SAAUC,GAEtC,MADFA,EAAEC,SAAWD,EAAEE,QAEtB/H,EAAE,uBAAuBa,OAEjC,IAEAb,EAAE,0BAA0Ba,OAAM,WACa,YAAvCb,EAAE,qBAAqB8G,KAAK,QAC5B9G,EAAE,qBAAqB8G,KAAK,OAAQ,QAEpC9G,EAAE,qBAAqB8G,KAAK,OAAQ,WAE5C,IAEA9G,EAAE,kCAAkCa,OAAM,WACtCb,EAAE,uBAAuBgE,SAAS,gBAElChE,EAAEyE,KAAK,CACHC,OAAQ,SACRC,IAAK1E,EAAG2E,YAAY,QAAUxE,IAAIC,WAAWG,QAAU,0BACvDsD,QAAS,SAAmBqB,GACxBnF,EAAE,uBAAuBoF,YAAY,gBACjCD,GACAK,IAAIC,MAAM3B,QAAQ7B,EAAE7B,IAAIC,WAAWG,QAAS,oCAEpD,GAER,IAEAR,EAAE,0BAA0BgI,QAAO,WAC/B,IAAIC,EAAOtC,KAAKuC,MAAM,IACX,IAAIC,UAEVC,OAAO,OAAQH,GAEpBjI,EAAE,uBAAuBgE,SAAS,gBAClC5D,IAAIC,WAAWgI,YAAYJ,GAAM,CAACK,EAAUjD,KAExCrF,EAAE,uBAAuBoF,YAAY,gBACrC,IAAImD,EAAUlD,EAAQpD,EAAE7B,IAAIC,WAAWG,QAAS,SAAW,KAAO6E,EAC5CpD,EAAE7B,IAAIC,WAAWG,QAAS,+BAE5C6E,EACAG,IAAIC,MAAMJ,MAAMkD,IAIhBD,GACAlI,IAAIC,WAAWmI,mBAAmBF,GAEtC9C,IAAIC,MAAM3B,QAAQyE,GAAQ,GAElC,IAEAvI,EAAEE,UAAUuI,GAAG,QAAS,+BAA+B,SAAUC,GAC7D,IAAIC,EAAO3I,EAAE0I,EAAME,QAAQC,QAAQ,6BAC/BC,EAAa9I,EAAE2I,GAAM7B,KAAK,WAE9B9G,EAAE,uBAAuBgE,SAAS,gBAClC5D,IAAIC,WAAW0I,eAAeD,GAAa3D,IACvCnF,EAAE,uBAAuBoF,YAAY,gBAErC,IAAImD,EAAUpD,EAASE,MAAQpD,EAAE7B,IAAIC,WAAWG,QAAS,SAAW,KAAO2E,EAASE,MACrDpD,EAAE7B,IAAIC,WAAWG,QAAS,iCACrD2E,EAASE,MACTG,IAAIC,MAAMJ,MAAMkD,IAIpBvI,EAAE2I,GAAMK,SACRxD,IAAIC,MAAM3B,QAAQyE,GAAQ,GAElC,IAEAvI,EAAEE,UAAUuI,GAAG,QAAS,+BAA+B,SAAUC,GAC7D,IAAIC,EAAO3I,EAAE0I,EAAME,QAAQC,QAAQ,6BAC/BC,EAAa9I,EAAE2I,GAAM7B,KAAK,WAE1BnC,EAAM1E,EAAG2E,YAAY,SAAWxE,IAAIC,WAAWG,QAAU,gCAC7D,CACIyI,OAAQH,EACRR,SAAU,SAGdY,OAAOC,KAAKxE,EAChB,IAEA3E,EAAEE,UAAUuI,GAAG,QAAS,iCAAiC,SAAUC,GAC/D,IAAIC,EAAO3I,EAAE0I,EAAME,QAAQC,QAAQ,6BAC/BC,EAAa9I,EAAE2I,GAAM7B,KAAK,WAE1BsC,EAAenJ,EAAG2E,YAAY,QAAUxE,IAAIC,WAAWG,QAAU,kDAAkD,CACnHyI,OAAQH,EACRR,SAAU,SAGde,SAASC,KAAOF,CACpB,GACJ,GAEH,CAxYD,CAwYGG,OAAQtJ","sources":["webpack:///onlyoffice/src/settings.js"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2024\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n(function ($, OC) {\n\n    $(document).ready(function () {\n        OCA.Onlyoffice = _.extend({}, OCA.Onlyoffice);\n        if (!OCA.Onlyoffice.AppName) {\n            OCA.Onlyoffice = {\n                AppName: \"onlyoffice\"\n            };\n        }\n\n        var advToogle = function () {\n            $(\"#onlyofficeSecretPanel\").toggleClass(\"onlyoffice-hide\");\n            $(\"#onlyofficeAdv .icon\").toggleClass(\"icon-triangle-s icon-triangle-n\");\n        };\n\n        if ($(\"#onlyofficeInternalUrl\").val().length\n            || $(\"#onlyofficeStorageUrl\").val().length\n            || $(\"#onlyofficeJwtHeader\").val().length) {\n            advToogle();\n        }\n\n        $(\"#onlyofficeAdv\").click(advToogle);\n\n        $(\"#onlyofficeGroups\").prop(\"checked\", $(\"#onlyofficeLimitGroups\").val() != \"\");\n\n        var groupListToggle = function () {\n            if ($(\"#onlyofficeGroups\").prop(\"checked\")) {\n                OC.Settings.setupGroupsSelect($(\"#onlyofficeLimitGroups\"));\n            } else {\n                $(\"#onlyofficeLimitGroups\").select2(\"destroy\");\n            }\n        };\n\n        $(\"#onlyofficeGroups\").click(groupListToggle);\n        groupListToggle();\n\n        var demoToggle = function () {\n            $(\"#onlyofficeAddrSettings input:not(#onlyofficeStorageUrl)\").prop(\"disabled\", $(\"#onlyofficeDemo\").prop(\"checked\"));\n        };\n\n        $(\"#onlyofficeDemo\").click(demoToggle);\n        demoToggle();\n\n        var watermarkToggle = function () {\n            $(\"#onlyofficeWatermarkSettings\").toggleClass(\"onlyoffice-hide\", !$(\"#onlyofficeWatermark_enabled\").prop(\"checked\"));\n        };\n\n        $(\"#onlyofficeWatermark_enabled\").click(watermarkToggle)\n\n        $(\"#onlyofficeWatermark_shareAll\").click(function () {\n            $(\"#onlyofficeWatermark_shareRead\").parent().toggleClass(\"onlyoffice-hide\");\n        });\n\n        $(\"#onlyofficeWatermark_linkAll\").click(function () {\n            $(\"#onlyofficeWatermark_link_sensitive\").toggleClass(\"onlyoffice-hide\");\n        });\n\n        var watermarkGroupLists = [\n            \"allGroups\"\n        ];\n\n        var watermarkTagLists = [\n            \"allTags\",\n            \"linkTags\",\n        ];\n\n        var watermarkNodeBehaviour = function (watermark){\n            var watermarkListToggle = function () {\n                if ($(\"#onlyofficeWatermark_\" + watermark).prop(\"checked\")) {\n                    if (watermark.indexOf(\"Group\") >= 0) {\n                        OC.Settings.setupGroupsSelect($(\"#onlyofficeWatermark_\" + watermark + \"List\"));\n                    } else {\n                        $(\"#onlyofficeWatermark_\" + watermark + \"List\").select2({\n                            allowClear: true,\n                            closeOnSelect: false,\n                            multiple: true,\n                            separator: \"|\",\n                            toggleSelect: true,\n                            placeholder: t(OCA.Onlyoffice.AppName, \"Select tag\"),\n                            query: _.debounce(function (query) {\n                                query.callback({\n                                    results: OC.SystemTags.collection.filterByName(query.term)\n                                });\n                            }, 100, true),\n                            initSelection: function (element, callback) {\n                                var selection = ($(element).val() || []).split(\"|\").map(function (tagId) {\n                                    return OC.SystemTags.collection.get(tagId);\n                                });\n                                callback(selection);\n                            },\n                            formatResult: function (tag) {\n                                return OC.SystemTags.getDescriptiveTag(tag);\n                            },\n                            formatSelection: function (tag) {\n                                return tag.get(\"name\");\n                            },\n                            sortResults: function (results) {\n                                results.sort(function (a, b) {\n                                    return OC.Util.naturalSortCompare(a.get(\"name\"), b.get(\"name\"));\n                                });\n                                return results;\n                            }\n                        });\n                    }\n                } else {\n                    $(\"#onlyofficeWatermark_\" + watermark + \"List\").select2(\"destroy\");\n                }\n            };\n\n            $(\"#onlyofficeWatermark_\" + watermark).click(watermarkListToggle);\n            watermarkListToggle();\n        };\n\n        $.each(watermarkGroupLists, function (i, watermarkGroup) {\n            watermarkNodeBehaviour(watermarkGroup);\n        });\n\n        if (OC.SystemTags && OC.SystemTags.collection) {\n            OC.SystemTags.collection.fetch({\n                success: function () {\n                    $.each(watermarkTagLists, function (i, watermarkTag) {\n                        watermarkNodeBehaviour(watermarkTag);\n                    });\n                }\n            });\n        }\n\n        $(\"#onlyofficeAddrSave\").click(function () {\n            $(\".section-onlyoffice\").addClass(\"icon-loading\");\n            var onlyofficeUrl = $(\"#onlyofficeUrl\").val().trim();\n\n            if (!onlyofficeUrl.length) {\n                $(\"#onlyofficeInternalUrl, #onlyofficeStorageUrl, #onlyofficeSecret, #onlyofficeJwtHeader\").val(\"\");\n            }\n\n            var onlyofficeInternalUrl = ($(\"#onlyofficeInternalUrl:visible\").val() || \"\").trim();\n            var onlyofficeStorageUrl = ($(\"#onlyofficeStorageUrl:visible\").val() || \"\").trim();\n            var onlyofficeVerifyPeerOff = $(\"#onlyofficeVerifyPeerOff\").prop(\"checked\");\n            var onlyofficeSecret = ($(\"#onlyofficeSecret:visible\").val() || \"\").trim();\n            var jwtHeader = ($(\"#onlyofficeJwtHeader:visible\").val() || \"\").trim();\n            var demo = $(\"#onlyofficeDemo\").prop(\"checked\");\n\n            $.ajax({\n                method: \"PUT\",\n                url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/settings/address\"),\n                data: {\n                    documentserver: onlyofficeUrl,\n                    documentserverInternal: onlyofficeInternalUrl,\n                    storageUrl: onlyofficeStorageUrl,\n                    verifyPeerOff: onlyofficeVerifyPeerOff,\n                    secret: onlyofficeSecret,\n                    jwtHeader: jwtHeader,\n                    demo: demo\n                },\n                success: function onSuccess(response) {\n                    $(\".section-onlyoffice\").removeClass(\"icon-loading\");\n                    if (response && (response.documentserver != null || demo)) {\n                        $(\"#onlyofficeUrl\").val(response.documentserver);\n                        $(\"#onlyofficeInternalUrl\").val(response.documentserverInternal);\n                        $(\"#onlyofficeStorageUrl\").val(response.storageUrl);\n                        $(\"#onlyofficeSecret\").val(response.secret);\n                        $(\"#onlyofficeJwtHeader\").val(response.jwtHeader);\n\n                        $(\".section-onlyoffice-common, .section-onlyoffice-templates, .section-onlyoffice-watermark\").toggleClass(\"onlyoffice-hide\", (response.documentserver == null && !demo) || !!response.error.length);\n\n                        var versionMessage = response.version ? (\" (\" + t(OCA.Onlyoffice.AppName, \"version\") + \" \" + response.version + \")\") : \"\";\n\n                        if (response.error) {\n                            OCP.Toast.error(t(OCA.Onlyoffice.AppName, \"Error when trying to connect\") + \" (\" + response.error + \")\" + versionMessage);\n                        } else {\n                            OCP.Toast.success(t(OCA.Onlyoffice.AppName, \"Settings have been successfully updated\") + versionMessage);\n                        }\n                    } else {\n                        $(\".section-onlyoffice-common, .section-onlyoffice-templates, .section-onlyoffice-watermark\").addClass(\"onlyoffice-hide\")\n                    }\n                }\n            });\n        });\n\n        $(\"#onlyofficeSave\").click(function () {\n            $(\".section-onlyoffice\").addClass(\"icon-loading\");\n\n            var defFormats = {};\n            $(\"input[id^=\\\"onlyofficeDefFormat\\\"]\").each(function () {\n                defFormats[this.name] = this.checked;\n            });\n\n            var editFormats = {};\n            $(\"input[id^=\\\"onlyofficeEditFormat\\\"]\").each(function () {\n                editFormats[this.name] = this.checked;\n            });\n\n            var sameTab = $(\"#onlyofficeSameTab\").is(\":checked\");\n            var preview = $(\"#onlyofficePreview\").is(\":checked\");\n            var advanced = $(\"#onlyofficeAdvanced\").is(\":checked\");\n            var cronChecker = $(\"#onlyofficeCronChecker\").is(\":checked\");\n            var versionHistory = $(\"#onlyofficeVersionHistory\").is(\":checked\");\n\n            var limitGroupsString = $(\"#onlyofficeGroups\").prop(\"checked\") ? $(\"#onlyofficeLimitGroups\").val() : \"\";\n            var limitGroups = limitGroupsString ? limitGroupsString.split(\"|\") : [];\n\n            var chat = $(\"#onlyofficeChat\").is(\":checked\");\n            var compactHeader = $(\"#onlyofficeCompactHeader\").is(\":checked\");\n            var feedback = $(\"#onlyofficeFeedback\").is(\":checked\");\n            var forcesave = $(\"#onlyofficeForcesave\").is(\":checked\");\n            var help = $(\"#onlyofficeHelp\").is(\":checked\");\n            var toolbarNoTabs = $(\"#onlyofficeToolbarNoTabs\").is(\":checked\");\n            var reviewDisplay = $(\"input[type='radio'][name='reviewDisplay']:checked\").attr(\"id\").replace(\"onlyofficeReviewDisplay_\", \"\");\n            var theme = $(\"input[type='radio'][name='theme']:checked\").attr(\"id\").replace(\"onlyofficeTheme_\", \"\");\n\n            $.ajax({\n                method: \"PUT\",\n                url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/settings/common\"),\n                data: {\n                    defFormats: defFormats,\n                    editFormats: editFormats,\n                    sameTab: sameTab,\n                    preview: preview,\n                    advanced: advanced,\n                    cronChecker: cronChecker,\n                    versionHistory: versionHistory,\n                    limitGroups: limitGroups,\n                    chat: chat,\n                    compactHeader: compactHeader,\n                    feedback: feedback,\n                    forcesave: forcesave,\n                    help: help,\n                    toolbarNoTabs: toolbarNoTabs,\n                    reviewDisplay: reviewDisplay,\n                    theme: theme\n                },\n                success: function onSuccess(response) {\n                    $(\".section-onlyoffice\").removeClass(\"icon-loading\");\n                    if (response) {\n                        OCP.Toast.success(t(OCA.Onlyoffice.AppName, \"Settings have been successfully updated\"));\n                    }\n                }\n            });\n        });\n\n        $(\"#onlyofficeSecuritySave\").click(function () {\n            $(\".section-onlyoffice\").addClass(\"icon-loading\");\n\n            var plugins = $(\"#onlyofficePlugins\").is(\":checked\");\n            var macros = $(\"#onlyofficeMacros\").is(\":checked\");\n            var protection = $(\"input[type='radio'][name='protection']:checked\").attr(\"id\").replace(\"onlyofficeProtection_\", \"\");\n\n            var watermarkSettings = {\n                enabled: $(\"#onlyofficeWatermark_enabled\").is(\":checked\")\n            };\n            if (watermarkSettings.enabled) {\n                watermarkSettings.text = ($(\"#onlyofficeWatermark_text\").val() || \"\").trim();\n\n                var watermarkLabels = [\n                    \"allGroups\",\n                    \"allTags\",\n                    \"linkAll\",\n                    \"linkRead\",\n                    \"linkSecure\",\n                    \"linkTags\",\n                    \"shareAll\",\n                    \"shareRead\"\n                ];\n                $.each(watermarkLabels, function (i, watermarkLabel) {\n                    watermarkSettings[watermarkLabel] = $(\"#onlyofficeWatermark_\" + watermarkLabel).is(\":checked\");\n                });\n\n                $.each(watermarkGroupLists.concat(watermarkTagLists), function (i, watermarkList) {\n                    var list = $(\"#onlyofficeWatermark_\" + watermarkList).is(\":checked\") ? $(\"#onlyofficeWatermark_\" + watermarkList + \"List\").val() : \"\";\n                    watermarkSettings[watermarkList + \"List\"] = list ? list.split(\"|\") : [];\n                });\n            }\n\n            $.ajax({\n                method: \"PUT\",\n                url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/settings/security\"),\n                data: {\n                    watermarks: watermarkSettings,\n                    plugins: plugins,\n                    macros: macros,\n                    protection: protection\n                },\n                success: function onSuccess(response) {\n                    $(\".section-onlyoffice\").removeClass(\"icon-loading\");\n                    if (response) {\n                        OCP.Toast.success(t(OCA.Onlyoffice.AppName, \"Settings have been successfully updated\"));\n                    }\n                }\n            });\n        });\n\n        $(\".section-onlyoffice-addr input\").keypress(function (e) {\n            var code = e.keyCode || e.which;\n            if (code === 13) {\n                $(\"#onlyofficeAddrSave\").click();\n            }\n        });\n\n        $(\"#onlyofficeSecret-show\").click(function () {\n            if ($(\"#onlyofficeSecret\").attr(\"type\") == \"password\") {\n                $(\"#onlyofficeSecret\").attr(\"type\", \"text\");\n            } else {\n                $(\"#onlyofficeSecret\").attr(\"type\", \"password\");\n            }\n        });\n\n        $(\"#onlyofficeClearVersionHistory\").click(function () {\n            $(\".section-onlyoffice\").addClass(\"icon-loading\");\n\n            $.ajax({\n                method: \"DELETE\",\n                url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/settings/history\"),\n                success: function onSuccess(response) {\n                    $(\".section-onlyoffice\").removeClass(\"icon-loading\");\n                    if (response) {\n                        OCP.Toast.success(t(OCA.Onlyoffice.AppName, \"All history successfully deleted\"));\n                    }\n                }\n            });\n        });\n\n        $(\"#onlyofficeAddTemplate\").change(function () {\n            var file = this.files[0];\n            var data = new FormData();\n\n            data.append(\"file\", file);\n\n            $(\".section-onlyoffice\").addClass(\"icon-loading\");\n            OCA.Onlyoffice.AddTemplate(file, (template, error) => {\n\n                $(\".section-onlyoffice\").removeClass(\"icon-loading\");\n                var message = error ? t(OCA.Onlyoffice.AppName, \"Error\") + \": \" + error\n                                    : t(OCA.Onlyoffice.AppName, \"Template successfully added\");\n\n                if (error) {\n                    OCP.Toast.error(message);\n                    return;\n                }\n\n                if (template) {\n                    OCA.Onlyoffice.AttachItemTemplate(template);\n                }\n                OCP.Toast.success(message);\n            });\n        });\n\n        $(document).on(\"click\", \".onlyoffice-template-delete\", function (event) {\n            var item = $(event.target).parents(\".onlyoffice-template-item\");\n            var templateId = $(item).attr(\"data-id\");\n\n            $(\".section-onlyoffice\").addClass(\"icon-loading\");\n            OCA.Onlyoffice.DeleteTemplate(templateId, (response) => {\n                $(\".section-onlyoffice\").removeClass(\"icon-loading\");\n\n                var message = response.error ? t(OCA.Onlyoffice.AppName, \"Error\") + \": \" + response.error\n                                             : t(OCA.Onlyoffice.AppName, \"Template successfully deleted\");\n                if (response.error) {\n                    OCP.Toast.error(message);\n                    return;\n                }\n\n                $(item).detach();\n                OCP.Toast.success(message);\n            });\n        });\n\n        $(document).on(\"click\", \".onlyoffice-template-item p\", function (event) {\n            var item = $(event.target).parents(\".onlyoffice-template-item\");\n            var templateId = $(item).attr(\"data-id\");\n\n            var url = OC.generateUrl(\"/apps/\" + OCA.Onlyoffice.AppName + \"/{fileId}?template={template}\",\n            {\n                fileId: templateId,\n                template: \"true\"\n            });\n\n            window.open(url);\n        });\n\n        $(document).on(\"click\", \".onlyoffice-template-download\", function (event) {\n            var item = $(event.target).parents(\".onlyoffice-template-item\");\n            var templateId = $(item).attr(\"data-id\");\n\n            var downloadLink = OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/downloadas?fileId={fileId}&template={template}\",{\n                fileId: templateId,\n                template: \"true\"\n            });\n\n            location.href = downloadLink;\n        });\n    });\n\n})(jQuery, OC);\n"],"names":["$","OC","document","ready","OCA","Onlyoffice","_","extend","AppName","advToogle","toggleClass","val","length","click","prop","groupListToggle","Settings","setupGroupsSelect","select2","demoToggle","parent","watermarkGroupLists","watermarkTagLists","watermarkNodeBehaviour","watermark","watermarkListToggle","indexOf","allowClear","closeOnSelect","multiple","separator","toggleSelect","placeholder","t","query","debounce","callback","results","SystemTags","collection","filterByName","term","initSelection","element","split","map","tagId","get","formatResult","tag","getDescriptiveTag","formatSelection","sortResults","sort","a","b","Util","naturalSortCompare","each","i","watermarkGroup","fetch","success","watermarkTag","addClass","onlyofficeUrl","trim","onlyofficeInternalUrl","onlyofficeStorageUrl","onlyofficeVerifyPeerOff","onlyofficeSecret","jwtHeader","demo","ajax","method","url","generateUrl","data","documentserver","documentserverInternal","storageUrl","verifyPeerOff","secret","response","removeClass","error","versionMessage","version","OCP","Toast","defFormats","this","name","checked","editFormats","sameTab","is","preview","advanced","cronChecker","versionHistory","limitGroupsString","limitGroups","chat","compactHeader","feedback","forcesave","help","toolbarNoTabs","reviewDisplay","attr","replace","theme","plugins","macros","protection","watermarkSettings","enabled","text","watermarkLabel","concat","watermarkList","list","watermarks","keypress","e","keyCode","which","change","file","files","FormData","append","AddTemplate","template","message","AttachItemTemplate","on","event","item","target","parents","templateId","DeleteTemplate","detach","fileId","window","open","downloadLink","location","href","jQuery"],"sourceRoot":""}