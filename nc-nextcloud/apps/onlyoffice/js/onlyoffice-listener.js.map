{"version":3,"file":"onlyoffice-listener.js?v=0dd60463696d6d6f0544","mappings":"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","sources":["webpack:///onlyoffice/src/listener.js"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2024\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n(function (OCA) {\n\n    OCA.Onlyoffice = _.extend({\n            AppName: \"onlyoffice\",\n            frameSelector: null,\n        }, OCA.Onlyoffice);\n\n    OCA.Onlyoffice.onRequestClose = function () {\n\n        $(OCA.Onlyoffice.frameSelector).remove();\n\n        if (OCA.Viewer && OCA.Viewer.close) {\n            OCA.Viewer.close();\n        }\n\n        if (OCA.Onlyoffice.CloseEditor) {\n            OCA.Onlyoffice.CloseEditor();\n        }\n    };\n\n    OCA.Onlyoffice.onRequestSaveAs = function (saveData) {\n\n        OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Save as\"),\n            function (fileDir) {\n                saveData.dir = fileDir;\n                $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSaveAs(saveData);\n            },\n            false,\n            \"httpd/unix-directory\",\n            true,\n            OC.dialogs.FILEPICKER_TYPE_CHOOSE,\n            saveData.dir);\n    };\n\n    OCA.Onlyoffice.onRequestInsertImage = function (imageMimes) {\n        OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Insert image\"),\n            $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorInsertImage,\n            false,\n            imageMimes,\n            true);\n    };\n\n    OCA.Onlyoffice.onRequestMailMergeRecipients = function (recipientMimes) {\n        OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Select recipients\"),\n            $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSetRecipient,\n            false,\n            recipientMimes,\n            true);\n    };\n\n    OCA.Onlyoffice.onRequestSelectDocument = function (revisedMimes, documentSelectionType) {\n        switch (documentSelectionType) {\n            case \"combine\":\n                var title =  t(OCA.Onlyoffice.AppName, \"Select file to combine\");\n                break;\n            default:\n                title =  t(OCA.Onlyoffice.AppName, \"Select file to compare\");\n        }\n        OC.dialogs.filepicker(title,\n            $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSetRequested.bind({documentSelectionType: documentSelectionType}),\n            false,\n            revisedMimes,\n            true);\n    };\n\n    OCA.Onlyoffice.onRequestReferenceSource = function (referenceSourceMimes) {\n        OC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, \"Select data source\"),\n            $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorReferenceSource,\n            false,\n            referenceSourceMimes,\n            true);\n    }\n\n    OCA.Onlyoffice.onDocumentReady = function () {\n        OCA.Onlyoffice.setViewport();\n    };\n\n    OCA.Onlyoffice.changeFavicon = function (favicon) {\n        $('link[rel=\"icon\"]').attr(\"href\", favicon);\n    };\n\n    OCA.Onlyoffice.setViewport = function() {\n        document.querySelector('meta[name=\"viewport\"]').setAttribute(\"content\",\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0\");\n    };\n\n    OCA.Onlyoffice.onShowMessage = function (messageObj) {\n        switch (messageObj.type) {\n            case \"success\":\n                OCP.Toast.success(messageObj.message, messageObj.props);\n                break;\n            case \"error\":\n                OCP.Toast.error(messageObj.message, messageObj.props);\n                break;\n        }\n    };\n\n    OCA.Onlyoffice.onRequestEditRights = function () {\n        $(OCA.Onlyoffice.frameSelector).attr(\"src\", $(OCA.Onlyoffice.frameSelector).attr(\"src\") + \"&forceEdit=true\");\n    };\n\n    window.addEventListener(\"message\", function (event) {\n        if (!$(OCA.Onlyoffice.frameSelector).length\n            || $(OCA.Onlyoffice.frameSelector)[0].contentWindow !== event.source\n            || !event.data[\"method\"]) {\n            return;\n        }\n        switch (event.data.method) {\n            case \"editorRequestClose\":\n                OCA.Onlyoffice.onRequestClose();\n                break;\n            case \"editorRequestSharingSettings\":\n                if (OCA.Onlyoffice.OpenShareDialog) {\n                    OCA.Onlyoffice.OpenShareDialog();\n                }\n                break;\n            case \"onRefreshVersionsDialog\":\n                if (OCA.Onlyoffice.RefreshVersionsDialog) {\n                    OCA.Onlyoffice.RefreshVersionsDialog();\n                }\n                break;\n            case \"editorRequestSaveAs\":\n                OCA.Onlyoffice.onRequestSaveAs(event.data.param);\n                break;\n            case \"editorRequestInsertImage\":\n                OCA.Onlyoffice.onRequestInsertImage(event.data.param);\n                break;\n            case \"editorRequestMailMergeRecipients\":\n                OCA.Onlyoffice.onRequestMailMergeRecipients(event.data.param);\n                break;\n            case \"editorRequestSelectDocument\":\n                OCA.Onlyoffice.onRequestSelectDocument(event.data.param, event.data.documentSelectionType);\n                break;\n            case \"editorRequestReferenceSource\":\n                OCA.Onlyoffice.onRequestReferenceSource(event.data.param);\n                break;\n            case \"onDocumentReady\":\n                OCA.Onlyoffice.onDocumentReady(event.data.param);\n                break;\n            case \"changeFavicon\":\n                OCA.Onlyoffice.changeFavicon(event.data.param);\n                break;\n            case \"onShowMessage\":\n                OCA.Onlyoffice.onShowMessage(event.data.param);\n                break;\n            case \"onRequestEditRights\":\n                OCA.Onlyoffice.onRequestEditRights();\n        }\n    }, false);\n\n    window.addEventListener(\"popstate\", function (event) {\n        if ($(OCA.Onlyoffice.frameSelector).length) {\n            OCA.Onlyoffice.onRequestClose();\n        }\n    });\n\n    window.addEventListener(\"DOMNodeRemoved\", function(event) {\n        if ($(event.target).length\n            && $(OCA.Onlyoffice.frameSelector).length > 0\n            && $(OCA.Onlyoffice.frameSelector)[0].contentWindow\n            && $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA\n            && ($(event.target)[0].id === \"viewer\" || $(event.target)[0].id === $(OCA.Onlyoffice.frameSelector)[0].id)) {\n\n            OCA.Onlyoffice.changeFavicon($(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.faviconBase);\n            window.document.title = $(OCA.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.titleBase;\n        }\n    });\n})(OCA);\n"],"names":["OCA","Onlyoffice","_","extend","AppName","frameSelector","onRequestClose","$","remove","Viewer","close","CloseEditor","onRequestSaveAs","saveData","OC","dialogs","filepicker","t","fileDir","dir","contentWindow","editorSaveAs","FILEPICKER_TYPE_CHOOSE","onRequestInsertImage","imageMimes","editorInsertImage","onRequestMailMergeRecipients","recipientMimes","editorSetRecipient","onRequestSelectDocument","revisedMimes","documentSelectionType","title","editorSetRequested","bind","onRequestReferenceSource","referenceSourceMimes","editorReferenceSource","onDocumentReady","setViewport","changeFavicon","favicon","attr","document","querySelector","setAttribute","onShowMessage","messageObj","type","OCP","Toast","success","message","props","error","onRequestEditRights","window","addEventListener","event","length","source","data","method","OpenShareDialog","RefreshVersionsDialog","param","target","id","faviconBase","titleBase"],"sourceRoot":""}