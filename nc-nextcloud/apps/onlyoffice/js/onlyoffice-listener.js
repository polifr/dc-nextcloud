!function(e){e.Onlyoffice=_.extend({AppName:"onlyoffice",frameSelector:null},e.Onlyoffice),e.Onlyoffice.onRequestClose=function(){$(e.Onlyoffice.frameSelector).remove(),e.Viewer&&e.Viewer.close&&e.Viewer.close(),e.Onlyoffice.CloseEditor&&e.Onlyoffice.CloseEditor()},e.Onlyoffice.onRequestSaveAs=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Save as"),(function(n){o.dir=n,$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSaveAs(o)}),!1,"httpd/unix-directory",!0,OC.dialogs.FILEPICKER_TYPE_CHOOSE,o.dir)},e.Onlyoffice.onRequestInsertImage=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Insert image"),$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorInsertImage,!1,o,!0)},e.Onlyoffice.onRequestMailMergeRecipients=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Select recipients"),$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSetRecipient,!1,o,!0)},e.Onlyoffice.onRequestSelectDocument=function(o,n){if("combine"===n)var i=t(e.Onlyoffice.AppName,"Select file to combine");else i=t(e.Onlyoffice.AppName,"Select file to compare");OC.dialogs.filepicker(i,$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSetRequested.bind({documentSelectionType:n}),!1,o,!0)},e.Onlyoffice.onRequestReferenceSource=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Select data source"),$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorReferenceSource,!1,o,!0)},e.Onlyoffice.onDocumentReady=function(){e.Onlyoffice.setViewport()},e.Onlyoffice.changeFavicon=function(e){$('link[rel="icon"]').attr("href",e)},e.Onlyoffice.setViewport=function(){document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")},e.Onlyoffice.onShowMessage=function(e){switch(e.type){case"success":OCP.Toast.success(e.message,e.props);break;case"error":OCP.Toast.error(e.message,e.props)}},e.Onlyoffice.onRequestEditRights=function(){$(e.Onlyoffice.frameSelector).attr("src",$(e.Onlyoffice.frameSelector).attr("src")+"&forceEdit=true")},window.addEventListener("message",(function(o){if($(e.Onlyoffice.frameSelector).length&&$(e.Onlyoffice.frameSelector)[0].contentWindow===o.source&&o.data.method)switch(o.data.method){case"editorRequestClose":e.Onlyoffice.onRequestClose();break;case"editorRequestSharingSettings":e.Onlyoffice.OpenShareDialog&&e.Onlyoffice.OpenShareDialog();break;case"onRefreshVersionsDialog":e.Onlyoffice.RefreshVersionsDialog&&e.Onlyoffice.RefreshVersionsDialog();break;case"editorRequestSaveAs":e.Onlyoffice.onRequestSaveAs(o.data.param);break;case"editorRequestInsertImage":e.Onlyoffice.onRequestInsertImage(o.data.param);break;case"editorRequestMailMergeRecipients":e.Onlyoffice.onRequestMailMergeRecipients(o.data.param);break;case"editorRequestSelectDocument":e.Onlyoffice.onRequestSelectDocument(o.data.param,o.data.documentSelectionType);break;case"editorRequestReferenceSource":e.Onlyoffice.onRequestReferenceSource(o.data.param);break;case"onDocumentReady":e.Onlyoffice.onDocumentReady(o.data.param);break;case"changeFavicon":e.Onlyoffice.changeFavicon(o.data.param);break;case"onShowMessage":e.Onlyoffice.onShowMessage(o.data.param);break;case"onRequestEditRights":e.Onlyoffice.onRequestEditRights()}}),!1),window.addEventListener("popstate",(function(o){$(e.Onlyoffice.frameSelector).length&&e.Onlyoffice.onRequestClose()})),window.addEventListener("DOMNodeRemoved",(function(o){$(o.target).length&&$(e.Onlyoffice.frameSelector).length>0&&$(e.Onlyoffice.frameSelector)[0].contentWindow&&$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA&&("viewer"===$(o.target)[0].id||$(o.target)[0].id===$(e.Onlyoffice.frameSelector)[0].id)&&(e.Onlyoffice.changeFavicon($(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.faviconBase),window.document.title=$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.titleBase)}))}(OCA);
//# sourceMappingURL=onlyoffice-listener.js.map?v=0dd60463696d6d6f0544