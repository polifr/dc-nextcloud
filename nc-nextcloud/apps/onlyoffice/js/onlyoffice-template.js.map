{"version":3,"file":"onlyoffice-template.js?v=a494e0c3462ba77fbe37","mappings":"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","sources":["webpack:///onlyoffice/src/template.js"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2024\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n (function ($, OC) {\n\n    OCA.Onlyoffice = _.extend({\n        AppName: \"onlyoffice\",\n        templates: null\n    }, OCA.Onlyoffice);\n\n    OCA.Onlyoffice.OpenTemplatePicker = function (name, extension, type) {\n\n        $(\"#onlyoffice-template-picker\").remove();\n\n        $.get(OC.filePath(OCA.Onlyoffice.AppName, \"templates\", \"templatePicker.html\"), \n            function (tmpl) {\n                var $tmpl = $(tmpl)\n                var dialog = $tmpl.octemplate({\n                    dialog_name: \"onlyoffice-template-picker\",\n                    dialog_title: t(OCA.Onlyoffice.AppName, \"Select template\")\n                });\n\n                OCA.Onlyoffice.AttachTemplates(dialog, type);\n\n                $(\"body\").append(dialog);\n\n                $(\"#onlyoffice-template-picker\").ocdialog({\n                    closeOnEscape: true,\n                    modal: true,\n                    buttons: [{\n                        text: t(\"core\", \"Cancel\"),\n                        classes: \"cancel\",\n                        click: function() {\n                            $(this).ocdialog(\"close\")\n                        }\n                    }, {\n                        text: t(OCA.Onlyoffice.AppName, \"Create\"),\n                        classes: \"primary\",\n                        click: function() {\n                            var templateId = this.dataset.templateId;\n                            var fileList = OCA.Files.App.fileList;\n                            OCA.Onlyoffice.CreateFile(name + extension, fileList, templateId);\n                            $(this).ocdialog(\"close\")\n                        }\n                    }]\n                });\n            });\n    };\n\n    OCA.Onlyoffice.GetTemplates = function () {\n        if (OCA.Onlyoffice.templates != null) {\n            return;\n        }\n\n        $.get(OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/template\"),\n            function onSuccess(response) {\n                if (response.error) {\n                    OC.Notification.show(response.error, {\n                        type: \"error\",\n                        timeout: 3\n                    });\n                    return;\n                }\n\n                OCA.Onlyoffice.templates = response;\n                return;\n            });\n    };\n\n    OCA.Onlyoffice.AddTemplate = function (file, callback) {\n        var data = new FormData();\n        data.append(\"file\", file);\n\n        $.ajax({\n            method: \"POST\",\n            url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/template\"),\n            data: data,\n            processData: false,\n            contentType: false,\n            success: function onSuccess(response) {\n                if (response.error) {\n                    callback(null, response.error)\n                    return;\n                }\n\n                callback(response, null);\n            }\n        });\n    }\n\n    OCA.Onlyoffice.DeleteTemplate = function (templateId, callback) {\n        $.ajax({\n            method: \"DELETE\",\n            url: OC.generateUrl(\"apps/\" + OCA.Onlyoffice.AppName + \"/ajax/template?templateId={templateId}\",\n            {\n                templateId: templateId\n            }),\n            success: function onSuccess(response) {\n                if (response) {\n                    callback(response);\n                }\n            }\n        });\n    }\n\n    OCA.Onlyoffice.AttachTemplates = function (dialog, type) {\n        var emptyItem = dialog[0].querySelector(\".onlyoffice-template-item\");\n\n        OCA.Onlyoffice.templates.forEach(template => {\n            if (template.type !== type) {\n                return;\n            }\n            var item = emptyItem.cloneNode(true);\n\n            $(item.querySelector(\"label\")).attr(\"for\", \"template_picker-\" + template[\"id\"]);\n            item.querySelector(\"input\").id = \"template_picker-\" + template[\"id\"];\n            item.querySelector(\"img\").src = \"../../core/img/filetypes/x-office-\" + template[\"type\"] + \".svg\";\n            item.querySelector(\"p\").textContent = template[\"name\"];\n            item.onclick = function() {\n                dialog[0].dataset.templateId = template[\"id\"];\n            }\n            dialog[0].querySelector(\".onlyoffice-template-container\").appendChild(item);\n        });\n\n        $(emptyItem.querySelector(\"label\")).attr(\"for\", \"template_picker-0\");\n        emptyItem.querySelector(\"input\").id = \"template_picker-0\";\n        emptyItem.querySelector(\"input\").checked = true;\n        emptyItem.querySelector(\"img\").src = \"../../core/img/filetypes/x-office-\" + type + \".svg\";\n        emptyItem.querySelector(\"p\").textContent = t(OCA.Onlyoffice.AppName, \"Empty\");\n        emptyItem.onclick = function() {\n            dialog[0].dataset.templateId = \"0\";\n        }\n    }\n\n    OCA.Onlyoffice.AttachItemTemplate = function (template) {\n        $.get(OC.filePath(OCA.Onlyoffice.AppName, \"templates\", \"templateItem.html\"),\n        function (item) {\n            var item = $(item)\n\n            item.attr(\"data-id\", template.id);\n            item.children(\"img\").attr(\"src\", \"../../core/img/filetypes/x-office-\" + template.type + \".svg\");\n            item.children(\"p\").text(template.name);\n\n            $(\".onlyoffice-template-container\").append(item);\n        });\n    }\n\n    OCA.Onlyoffice.TemplateExist = function (type) {\n        var isExist = OCA.Onlyoffice.templates.some((template) => {\n            return template.type === type;\n        });\n\n        return isExist;\n    }\n\n})(jQuery, OC);"],"names":["$","OC","OCA","Onlyoffice","_","extend","AppName","templates","OpenTemplatePicker","name","extension","type","remove","get","filePath","tmpl","dialog","octemplate","dialog_name","dialog_title","t","AttachTemplates","append","ocdialog","closeOnEscape","modal","buttons","text","classes","click","this","templateId","dataset","fileList","Files","App","CreateFile","GetTemplates","generateUrl","response","error","Notification","show","timeout","AddTemplate","file","callback","data","FormData","ajax","method","url","processData","contentType","success","DeleteTemplate","emptyItem","querySelector","forEach","template","item","cloneNode","attr","id","src","textContent","onclick","appendChild","checked","AttachItemTemplate","children","TemplateExist","some","jQuery"],"sourceRoot":""}